<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Blog for Myself">
<meta property="og:type" content="website">
<meta property="og:title" content="ZYL的博客">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="ZYL的博客">
<meta property="og:description" content="Blog for Myself">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="PiPiLong">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/page/2/"/>





  <title>ZYL的博客</title>
  








<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZYL的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">码住</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/23/OOP%E5%A4%8D%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/12/23/OOP%E5%A4%8D%E4%B9%A0/" itemprop="url">OOP复习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-12-23T20:05:07+08:00">
                2020-12-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  1.9k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="OOP复习-指北"><a href="#OOP复习-指北" class="headerlink" title="OOP复习 指北"></a>OOP复习 指北</h1><ol>
<li><p>工厂方法               P117</p>
</li>
<li><p>静态boolean 为false main方法中的boolean  没有初始值</p>
</li>
<li><p>this 在一个构造器中调用另一个构造器方法</p>
</li>
<li><p>静态初始化块 运行次序高于初始化块 且随着第一个类对象的创立只运行一次，且调用程序的静态方法，不创建对象时，该static 方法体也会被执行，仅执行一次。初始化块的运行次序 高于 构造器方法,不论放置的次序如何。</p>
<p>执行顺序: 父类的静态方法—-&gt;子类的静态方法—-&gt; 父类的构造—-&gt;子类的构造..</p>
<p>单个类：静态初始化块–&gt;成员变量初始化—&gt;块作用域—&gt;构造方法</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/12/23/OOP%E5%A4%8D%E4%B9%A0/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/22/%E5%AE%89%E5%8D%93%E6%95%B0%E7%8B%AC%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/12/22/%E5%AE%89%E5%8D%93%E6%95%B0%E7%8B%AC%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/" itemprop="url">安卓数独游戏课设</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-12-22T20:05:07+08:00">
                2020-12-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index">
                    <span itemprop="name">个人项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  3.1k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="数独游戏-回溯算法-—数据结构课程设计实验报告"><a href="#数独游戏-回溯算法-—数据结构课程设计实验报告" class="headerlink" title="数独游戏 (回溯算法)—数据结构课程设计实验报告"></a>数独游戏 (回溯算法)—数据结构课程设计实验报告</h1><p>[toc]</p>
<!-- toc -->

<ul>
<li><a href="#%E6%B8%B8%E6%88%8F%E4%BB%8B%E7%BB%8D">游戏介绍</a><ul>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E5%8A%9F%E8%83%BD">实现功能：</a></li>
<li><a href="#%E6%B8%B8%E6%88%8F%E6%93%8D%E4%BD%9C%E8%AF%B4%E6%98%8E">游戏操作说明：</a></li>
<li><a href="#%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E8%AF%B4%E6%98%8E-%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81">项目运行说明 (如果需要)：</a></li>
</ul>
</li>
<li><a href="#%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95%E6%A0%B8%E5%BF%83%E9%83%A8%E5%88%86">游戏设计理念(回溯算法核心部分)</a><ul>
<li><a href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3">核心思想：</a></li>
<li><a href="#isvalid%E6%96%B9%E6%B3%95"><strong>isValid()方法</strong>：</a></li>
<li><a href="#isonlyone%E6%96%B9%E6%B3%95">isOnlyOne()方法</a></li>
<li><a href="#generatesudowithlevel%E6%96%B9%E6%B3%95">generateSudoWithLevel()方法</a></li>
<li><a href="#%E6%B5%81%E7%A8%8B%E6%A6%82%E6%8B%AC">流程概括</a></li>
<li><a href="#%E5%AE%9E%E9%AA%8C%E6%B5%8B%E8%AF%95-%E5%85%B7%E4%BD%93%E8%80%97%E6%97%B6">实验测试—具体耗时</a></li>
<li><a href="#%E5%AE%9E%E9%AA%8C%E5%88%86%E6%9E%90">实验分析</a></li>
</ul>
</li>
<li><a href="#%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91%E4%B8%AD%E7%9A%84%E5%85%B6%E4%BB%96%E6%83%B3%E6%B3%95%E5%92%8C%E9%97%AE%E9%A2%98">游戏开发中的其他想法和问题</a></li>
<li><a href="#%E8%AF%BE%E8%AE%BE%E6%80%BB%E7%BB%93">课设总结</a></li>
<li><a href="#%E6%84%9F%E8%B0%A2">感谢</a></li>
</ul>
<!-- tocstop -->

<hr>
<h2 id="游戏介绍"><a href="#游戏介绍" class="headerlink" title="游戏介绍"></a>游戏介绍</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ul>
<li>传统的数独游戏，采用 9x9 方格，通过填入数字 1-9 ，确保<strong>每行、每列、以及该格所在的 3x3 的方格区域</strong>中 不出现相同的数字。</li>
<li><strong>每个生成的数独只有一个解</strong></li>
<li>使用 AndroidStudio 平台开发 ，基于Java语言
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/12/22/%E5%AE%89%E5%8D%93%E6%95%B0%E7%8B%AC%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/22/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/10/22/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" itemprop="url">个人项目总结学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-10-22T20:05:07+08:00">
                2020-10-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  1.5k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="个人项目总结"><a href="#个人项目总结" class="headerlink" title="个人项目总结"></a>个人项目总结</h1><h2 id="JDBC-HTML-MYSQL-间通信"><a href="#JDBC-HTML-MYSQL-间通信" class="headerlink" title="JDBC \ HTML \ MYSQL 间通信"></a>JDBC \ HTML \ MYSQL 间通信</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>实现html 界面输入用户名密码，能够通过mysql 查询到相应的其他值，并且再输出到html界面上</p>
<!-- toc -->

<ul>
<li><a href="#%E9%87%87%E5%9D%91%E7%82%B9">采坑点</a></li>
</ul>
<ul>
<li><a href="#responsehtml-%E5%AE%9E%E7%8E%B0%E9%AA%8C%E8%AF%81%E7%A0%81-%E7%9A%84%E9%AA%8C%E8%AF%81%E5%92%8C%E6%9B%B4%E6%8D%A2">Response/HTML 实现验证码 的验证和更换</a></li>
<li><a href="#response-servletcontext-fileinputstream%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD">Response /ServletContext/ FileInputStream实现文件下载</a></li>
<li><a href="#gui-bufferedreader-regex-%E8%AF%BB%E5%8F%96%E6%96%87%E6%A1%A3%E7%B1%BB%E5%AF%B9%E8%B1%A1%E4%BF%A1%E6%81%AF%E5%B9%B6%E5%AD%98%E5%85%A5%E4%B8%BA%E5%85%B7%E4%BD%93%E5%AF%B9%E8%B1%A1%E8%BF%9B%E5%85%A5%E5%85%B7%E4%BD%93%E6%95%B0%E7%BB%84%E4%B8%AD">GUI / BufferedReader /  Regex 读取文档类对象信息并存入为具体对象进入具体数组中</a></li>
</ul>
<!-- tocstop -->
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/10/22/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/05/23/%E6%8E%92%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/23/%E6%8E%92%E5%BA%8F/" itemprop="url">排序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-23T20:05:07+08:00">
                2020-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  838
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h1><p>[TOC]</p>
<hr>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/05/23/%E6%8E%92%E5%BA%8F/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/12/22/JDBC%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/22/JDBC%E5%AD%A6%E4%B9%A0/" itemprop="url">JDBC 学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-22T20:05:07+08:00">
                2019-12-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  768
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="JDBC-学习"><a href="#JDBC-学习" class="headerlink" title="JDBC 学习"></a>JDBC 学习</h1><hr>
<h2 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h2><p>** JAVA DATABASE CONNECTIVITY    **</p>
<ul>
<li>定义了 操作所有关系型数据库的规则（接口） —SUN公司定义<br>各个数据库厂商实现接口 ，提供驱动jar包 <strong>真正执行的代码是jar包中的实现类</strong></li>
</ul>
<hr>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/12/22/JDBC%E5%AD%A6%E4%B9%A0/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/12/22/JVM%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/22/JVM%E5%AD%A6%E4%B9%A0/" itemprop="url">JVM 学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-22T20:05:07+08:00">
                2019-12-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  16.8k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  60
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1><span id="jvm-学习日志">JVM 学习日志</span></h1><p>[toc]</p>
<!-- toc -->

<ul>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a><ul>
<li><a href="#jre-%E5%92%8C-jdk%E7%9A%84%E5%85%B3%E7%B3%BB">JRE 和 JDK的关系</a></li>
<li><a href="#jvm%E8%B7%A8%E8%AF%AD%E8%A8%80%E7%9A%84%E5%B9%B3%E5%8F%B0">JVM跨语言的平台</a></li>
<li><a href="#jvm%E7%9A%84%E8%AF%AD%E8%A8%80%E6%97%A0%E5%85%B3%E6%80%A7">JVM的语言无关性</a></li>
<li><a href="#jvm-%E5%AD%97%E8%8A%82%E7%A0%81">(JVM) 字节码</a><ul>
<li><a href="#%E5%A4%9A%E8%AF%AD%E8%A8%80%E6%B7%B7%E5%90%88%E7%BC%96%E7%A8%8B">多语言混合编程</a></li>
</ul>
</li>
<li><a href="#%E8%99%9A%E6%8B%9F%E6%9C%BA">虚拟机</a><ul>
<li><a href="#%E7%89%B9%E7%82%B9">特点：</a></li>
<li><a href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%9C%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE">虚拟机在计算机中的位置</a></li>
</ul>
</li>
<li><a href="#%E5%85%B6%E4%BB%96">其他</a></li>
</ul>
</li>
<li><a href="#%E6%AD%A3%E5%BC%8F%E8%BF%9B%E5%85%A5">正式进入</a><ul>
<li><a href="#java%E4%BB%A3%E7%A0%81%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B">Java代码的执行流程</a></li>
<li><a href="#jvm%E7%9A%84%E6%9E%B6%E6%9E%84">JVM的架构</a></li>
<li><a href="#jvm%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">JVM的生命周期</a></li>
</ul>
</li>
<li><a href="#%E7%B1%BB%E5%8A%A0%E8%BD%BD">类加载</a><ul>
<li><a href="#classloader">ClassLoader</a></li>
<li><a href="#%E5%8A%A0%E8%BD%BDloading">加载Loading：</a></li>
<li><a href="#%E9%93%BE%E6%8E%A5linking%E9%98%B6%E6%AE%B5">链接Linking阶段：</a><ul>
<li><a href="#%E9%AA%8C%E8%AF%81-verify">验证 Verify</a></li>
<li><a href="#%E5%87%86%E5%A4%87-prepare">准备 Prepare</a></li>
<li><a href="#%E8%A7%A3%E6%9E%90-resolve">解析 Resolve</a></li>
</ul>
</li>
<li><a href="#%E7%B1%BB%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96">类的初始化</a><ul>
<li><a href="#%E5%8F%98%E9%87%8F%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B">变量初始化过程</a></li>
</ul>
</li>
<li><a href="#%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%9A%84%E5%88%86%E7%B1%BB">加载器的分类</a><ul>
<li><a href="#bootstapclassload">BootStapClassLoad</a></li>
<li><a href="#appclassloader">AppClassLoader</a></li>
<li><a href="#extensionloader">ExtensionLoader</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8">自定义类加载器</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%9C%BA%E5%88%B6">双亲委派机制</a><ul>
<li><a href="#%E4%BC%98%E7%82%B9">优点</a></li>
</ul>
</li>
<li><a href="#%E6%B2%99%E7%AE%B1%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6">沙箱安全机制</a></li>
<li><a href="#%E5%85%B6%E4%BB%96-1">其他</a><ul>
<li><a href="#%E7%B1%BB%E7%9A%84%E4%B8%BB%E5%8A%A8%E4%BD%BF%E7%94%A8%E5%92%8C%E8%A2%AB%E5%8A%A8%E4%BD%BF%E7%94%A8">类的主动使用和被动使用</a></li>
</ul>
</li>
<li><a href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA">运行时数据区</a><ul>
<li><a href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A0%88">虚拟机栈</a><ul>
<li><a href="#%E6%A6%82%E5%BF%B5">概念</a></li>
<li><a href="#%E5%BC%82%E5%B8%B8">异常</a></li>
<li><a href="#%E6%A0%88%E5%B8%A7">栈帧</a><ul>
<li><a href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E8%A1%A8">局部变量表</a></li>
<li><a href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%A0%88">操作数栈</a></li>
<li><a href="#%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5">动态链接</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80">方法返回地址</a></li>
<li><a href="#%E9%99%84%E5%8A%A0%E4%BF%A1%E6%81%AF">附加信息</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%9C%AC%E5%9C%B0%E6%96%B9%E6%B3%95%E6%A0%88">本地方法栈</a><ul>
<li><a href="#%E6%9C%AC%E5%9C%B0%E6%96%B9%E6%B3%95%E6%8E%A5%E5%8F%A3%E5%92%8C%E5%BA%93">本地方法接口和库</a></li>
</ul>
</li>
<li><a href="#%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8">程序计数器</a><ul>
<li><a href="#pc%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E5%A5%BD%E5%A4%84">PC寄存器的好处</a></li>
<li><a href="#cpu%E6%97%B6%E9%97%B4%E7%89%87">CPU时间片</a></li>
</ul>
</li>
<li><a href="#%E5%A0%86">堆</a><ul>
<li><a href="#%E5%A0%86%E7%A9%BA%E9%97%B4%E7%BB%86%E5%88%86%E9%80%BB%E8%BE%91%E4%B8%8A">堆空间细分（逻辑上）</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E5%A0%86%E7%A9%BA%E9%97%B4%E5%A4%A7%E5%B0%8F">设置堆空间大小</a></li>
<li><a href="#%E5%A0%86%E7%A9%BA%E9%97%B4%E7%9A%84oom">堆空间的OOM</a></li>
<li><a href="#%E5%B9%B4%E8%BD%BB%E4%BB%A3%E4%B8%8E%E8%80%81%E5%B9%B4%E4%BB%A3">年轻代与老年代</a></li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E5%88%86%E9%85%8D%E8%BF%87%E7%A8%8B">对象分配过程</a></li>
<li><a href="#minor-gc-major-gc-full-gc">Minor GC、Major GC 、Full GC</a></li>
<li><a href="#tlab">TLAB</a></li>
<li><a href="#%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90">逃逸分析</a><ul>
<li><a href="#%E6%A0%88%E4%B8%8A%E5%88%86%E9%85%8D">栈上分配</a></li>
<li><a href="#%E5%90%8C%E6%AD%A5%E7%9C%81%E7%95%A5">同步省略</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96">代码优化</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%85%83%E7%A9%BA%E9%97%B4">元空间</a><ul>
<li><a href="#%E6%96%B9%E6%B3%95%E5%8C%BA-%E5%A0%86-%E6%A0%88%E7%9A%84%E4%BA%A4%E4%BA%92%E5%85%B3%E7%B3%BB">方法区 堆  栈的交互关系</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E5%85%83%E7%A9%BA%E9%97%B4%E5%A4%A7%E5%B0%8F">设置元空间大小</a></li>
<li><a href="#%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84">内部结构</a><ul>
<li><a href="#%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF">类型信息</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E4%BF%A1%E6%81%AF">方法信息</a></li>
<li><a href="#%E5%9F%9F%E4%BF%A1%E6%81%AF">域信息</a></li>
<li><a href="#non-final%E7%B1%BB%E5%8F%98%E9%87%8F">non-final类变量</a></li>
<li><a href="#%E5%85%A8%E5%B1%80%E5%B8%B8%E9%87%8F">全局常量</a></li>
</ul>
</li>
<li><a href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E5%B8%B8%E9%87%8F%E6%B1%A0">运行时常量池</a><ul>
<li><a href="#%E5%AD%97%E8%8A%82%E7%A0%81%E7%9A%84%E5%B8%B8%E9%87%8F%E6%B1%A0">字节码的常量池</a></li>
<li><a href="#%E5%8A%A8%E6%80%81%E6%80%A7">动态性</a></li>
<li><a href="#jdk16-17-18%E7%9A%84%E8%B0%83%E6%95%B4">JDK1.6–1.7–1.8的调整</a></li>
<li><a href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6">垃圾回收</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96%E9%9D%A2%E8%AF%95">对象的实例化(面试)</a><ul>
<li><a href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96">对象的实例化</a></li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E6%AD%A5%E9%AA%A4">对象创建步骤</a></li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80">对象的内存布局</a><ul>
<li><a href="#%E5%AF%B9%E8%B1%A1%E5%A4%B4">对象头</a></li>
<li><a href="#%E5%AE%9E%E4%BE%8B%E6%95%B0%E6%8D%AE">实例数据</a></li>
<li><a href="#instance-data">Instance Data</a></li>
<li><a href="#%E5%AF%B9%E9%BD%90%E5%A1%AB%E5%85%85">对齐填充</a></li>
<li><a href="#%E6%80%BB%E7%BB%93%E5%9B%BE%E7%A4%BA">总结图示</a></li>
</ul>
</li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E8%AE%BF%E9%97%AE%E5%AE%9A%E4%BD%8D">对象访问定位</a><ul>
<li><a href="#%E8%AE%BF%E9%97%AE%E6%96%B9%E5%BC%8F">访问方式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E7%9B%B4%E6%8E%A5%E5%86%85%E5%AD%98">直接内存</a></li>
<li><a href="#%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E">执行引擎</a><ul>
<li><a href="#%E6%A6%82%E8%BF%B0">概述</a></li>
<li><a href="#java%E4%BB%A3%E7%A0%81%E7%BC%96%E8%AF%91-%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%87%E7%A8%8B">Java代码编译、执行的过程</a></li>
<li><a href="#%E8%A7%A3%E9%87%8A%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8">解释器的使用</a></li>
<li><a href="#%E5%8D%B3%E6%97%B6%E7%BC%96%E8%AF%91-jit%E7%BC%96%E8%AF%91%E5%99%A8">即时编译 JIT编译器</a><ul>
<li><a href="#%E7%83%AD%E7%82%B9%E4%BB%A3%E7%A0%81%E5%92%8C%E6%8E%A2%E6%B5%8B%E6%96%B9%E5%BC%8F">热点代码和探测方式</a></li>
</ul>
</li>
<li><a href="#graal%E7%BC%96%E8%AF%91%E5%99%A8%E5%92%8Caot%E7%BC%96%E8%AF%91%E5%99%A8">Graal编译器和AOT编译器</a></li>
</ul>
</li>
<li><a href="#stringtable">StringTable</a><ul>
<li><a href="#%E5%9F%BA%E6%9C%AC%E7%89%B9%E6%80%A7">基本特性</a></li>
<li><a href="#string%E7%9A%84%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D">String的内存分配</a></li>
<li><a href="#intern">intern()</a></li>
</ul>
</li>
<li><a href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6-1">垃圾回收</a><ul>
<li><a href="#%E5%9E%83%E5%9C%BE%E6%A0%87%E8%AE%B0%E7%AE%97%E6%B3%95">垃圾标记算法</a><ul>
<li><a href="#%E5%AF%B9%E8%B1%A1%E5%AD%98%E6%B4%BB%E5%88%A4%E6%96%AD">对象存活判断</a><ul>
<li><a href="#1-%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0%E6%B3%95">1. 引用计数法</a></li>
<li><a href="#2-%E5%8F%AF%E8%BE%BE%E6%80%A7%E5%88%86%E6%9E%90%E7%AE%97%E6%B3%95">2. 可达性分析算法</a></li>
</ul>
</li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E7%9A%84finaliztion%E6%9C%BA%E5%88%B6">对象的finaliztion机制</a></li>
</ul>
</li>
<li><a href="#%E5%9E%83%E5%9C%BE%E6%B8%85%E9%99%A4%E7%AE%97%E6%B3%95">垃圾清除算法</a><ul>
<li><a href="#%E6%A0%87%E8%AE%B0-%E6%B8%85%E9%99%A4-%E7%AE%97%E6%B3%95">标记 - 清除 算法</a></li>
<li><a href="#%E5%A4%8D%E5%88%B6%E7%AE%97%E6%B3%95">复制算法</a></li>
<li><a href="#%E6%A0%87%E8%AE%B0-%E5%8E%8B%E7%BC%A9%E7%AE%97%E6%B3%95">标记 - 压缩算法</a></li>
<li><a href="#%E5%AF%B9%E6%AF%94">对比</a></li>
<li><a href="#%E5%88%86%E4%BB%A3%E6%94%B6%E9%9B%86%E7%AE%97%E6%B3%95">分代收集算法</a></li>
<li><a href="#%E5%A2%9E%E9%87%8F%E6%94%B6%E9%9B%86%E7%AE%97%E6%B3%95">增量收集算法</a></li>
<li><a href="#%E5%88%86%E5%8C%BA%E7%AE%97%E6%B3%95">分区算法</a></li>
</ul>
</li>
<li><a href="#%E6%A6%82%E5%BF%B5-1">概念</a><ul>
<li><a href="#systemgy">System,gy()</a></li>
<li><a href="#%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA">内存溢出</a></li>
<li><a href="#%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2">内存泄露</a></li>
<li><a href="#stw">STW</a></li>
<li><a href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%9A%84%E5%B9%B6%E8%A1%8C%E5%92%8C%E5%B9%B6%E5%8F%91">垃圾回收的并行和并发</a></li>
<li><a href="#%E5%AE%89%E5%85%A8%E7%82%B9%E5%92%8C%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9F">安全点和安全区域</a><ul>
<li><a href="#%E5%AE%89%E5%85%A8%E7%82%B9">安全点</a></li>
<li><a href="#%E5%AE%89%E5%85%A8%E5%8C%BA">安全区</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%BC%95%E7%94%A8">引用</a><ul>
<li><a href="#%E5%BC%BA%E5%BC%95%E7%94%A8">强引用</a></li>
<li><a href="#%E8%BD%AF%E5%BC%95%E7%94%A8soft">软引用Soft</a></li>
<li><a href="#%E5%BC%B1%E5%BC%95%E7%94%A8weak">弱引用Weak</a><ul>
<li><a href="#weakhashmap">WeakHashMap</a></li>
</ul>
</li>
<li><a href="#%E8%99%9A%E5%BC%95%E7%94%A8phantomreference">虚引用PhantomReference</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%9F">垃圾回收期</a><ul>
<li><a href="#%E6%8C%87%E6%A0%87">指标</a></li>
<li><a href="#serial">Serial</a></li>
<li><a href="#parnew">ParNew</a></li>
<li><a href="#parallel">Parallel</a></li>
<li><a href="#cms">CMS</a></li>
<li><a href="#g1">G1</a><ul>
<li><a href="#remeberedset-%E8%AE%B0%E5%BF%86%E9%9B%86">RemeberedSet 记忆集</a></li>
<li><a href="#%E5%9B%9E%E6%94%B6%E5%85%B7%E4%BD%93%E8%BF%87%E7%A8%8B">回收具体过程</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><a href="#%E6%B7%B1%E5%85%A5%E7%AF%87">深入篇</a><ul>
<li><a href="#%E5%AD%97%E8%8A%82%E7%A0%81">字节码</a><ul>
<li><a href="#%E7%BC%96%E8%AF%91">编译</a></li>
<li><a href="#%E6%A6%82%E5%BF%B5-2">概念</a><ul>
<li><a href="#class%E6%96%87%E4%BB%B6">Class文件</a></li>
</ul>
</li>
<li><a href="#class%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84">Class文件结构</a><ul>
<li><a href="#%E9%AD%94%E6%95%B0">魔数</a></li>
<li><a href="#class%E6%96%87%E4%BB%B6%E7%89%88%E6%9C%AC">Class文件版本</a></li>
<li><a href="#%E5%B8%B8%E9%87%8F%E6%B1%A0">常量池</a></li>
<li><a href="#%E8%AE%BF%E9%97%AE%E6%A0%87%E5%BF%97">访问标志</a></li>
<li><a href="#%E7%B1%BB%E7%B4%A2%E5%BC%95-%E7%88%B6%E7%B1%BB%E7%B4%A2%E5%BC%95-%E6%8E%A5%E5%8F%A3%E7%B4%A2%E5%BC%95%E9%9B%86%E5%90%88">类索引、父类索引、接口索引集合</a></li>
<li><a href="#%E5%AD%97%E6%AE%B5%E8%A1%A8%E9%9B%86%E5%90%88">字段表集合</a></li>
<li><a href="#%E6%96%B9%E6%B3%95%E8%A1%A8%E9%9B%86%E5%90%88">方法表集合</a></li>
<li><a href="#%E5%B1%9E%E6%80%A7%E8%A1%A8%E9%9B%86%E5%90%88">属性表集合</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA%E7%AF%87">查漏补缺篇</a><ul>
<li><a href="#%E6%8B%85%E4%BF%9D%E6%9C%BA%E5%88%B6">担保机制</a></li>
<li><a href="#%E6%99%8B%E5%8D%87%E5%8E%9F%E7%90%86">晋升原理</a></li>
<li><a href="#string">String</a></li>
<li><a href="#%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6">类加载机制</a><ul>
<li><a href="#%E7%B1%BB%E5%8A%A0%E8%BD%BD-1">类加载</a></li>
<li><a href="#%E9%93%BE%E6%8E%A5">链接</a><ul>
<li><a href="#%E9%AA%8C%E8%AF%81">验证</a></li>
<li><a href="#%E5%87%86%E5%A4%87">准备</a></li>
<li><a href="#%E8%A7%A3%E6%9E%90">解析</a></li>
</ul>
</li>
<li><a href="#%E5%88%9D%E5%A7%8B%E5%8C%96">初始化</a></li>
<li><a href="#clinit%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E6%80%A7">clinit的线程安全性</a></li>
<li><a href="#%E7%B1%BB%E7%9A%84%E4%B8%BB%E5%8A%A8%E4%BD%BF%E7%94%A8%E5%92%8C%E8%A2%AB%E5%8A%A8%E4%BD%BF%E7%94%A8-1">类的主动使用和被动使用</a><ul>
<li><a href="#%E4%B8%BB%E5%8A%A8%E4%BD%BF%E7%94%A8">主动使用</a></li>
<li><a href="#%E8%A2%AB%E5%8A%A8%E4%BD%BF%E7%94%A8">被动使用</a></li>
</ul>
</li>
<li><a href="#%E7%B1%BB%E5%8D%B8%E8%BD%BD-unloading">类卸载 Unloading</a></li>
</ul>
</li>
<li><a href="#%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A%E4%B8%8E%E9%9D%99%E6%80%81%E7%BB%91%E5%AE%9A">动态绑定与静态绑定</a></li>
<li><a href="#%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%9C%BA%E5%88%B6-1">双亲委派机制</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- tocstop -->

<hr>
<h2><span id="简介">简介</span></h2><p>JVM :       Java HotSoit Virtual Machine</p>
<p>   Write once,  run anywhere    </p>
<p>​    TIOBE 语言热度排行</p>
<p>Java 程序  —–&gt;编译为字节码文件(本身具有跨平台性)    —-&gt;不同操作系统上JVM</p>
<h3><span id="jre-和-jdk的关系">JRE 和 JDK的关系</span></h3><p>JDK：它是Java开发运行环境，在程序员的电脑上当然要安装JDK；<br>JRE：Java Runtime Environment它是Java运行环境，如果你不需要开发只需要运行Java程序，那么你可以安装JRE。例如程序员开发出的程序最终卖给了用户，用户不用开发，只需要运行程序，所以用户在电脑上安装JRE即可。<br>JDK包含了JRE。<br>JRE中包含虚拟机JVM</p>
<h3><span id="jvm跨语言的平台">JVM跨语言的平台</span></h3><p>JVM起始 从<strong>字节码</strong>开始   </p>
<p>字节码文件可以由不同的编程语言提供 在java平台<strong>解释</strong>运行</p>
<p>由不同的编程语言提供不同的<strong>编译器</strong></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224091832738.png" alt="image-20210224091832738"></p>
<h3><span id="jvm的语言无关性">JVM的语言无关性</span></h3><p>Java虚拟机不关心在内部运行的程序是用何种编程语言写的</p>
<p>只关心字节码文件  </p>
<p>只要其他编程语言的编译结果满足并包含Java虚拟机的内部指令集，符号表以及请他信息，他就可以被装载和运行</p>
<h3><span id="jvm-字节码">(JVM) 字节码</span></h3><p>通过编译器编译能在JVM上运行的二进制文件格式</p>
<p>不同的编译器可以编译出相同的字节码文件  字节码文件可以在不同的JVM上运行</p>
<h4><span id="多语言混合编程">多语言混合编程</span></h4><p>JDK 1.5 —&gt; Java SE 5.0 </p>
<h3><span id="虚拟机">虚拟机</span></h3><p>软件：执行一系列虚拟计算机指令     </p>
<p>分类  ：</p>
<ul>
<li>系统虚拟机: 提供可运行完整操作系统的软件平台，是对物理计算机的仿真</li>
<li>程序虚拟机:专门为<strong>执行单个计算机程序</strong>设计的   Java虚拟机中执行的指令 — 字节码指令</li>
</ul>
<h4><span id="特点">特点：</span></h4><ol>
<li>一次编译到处运行</li>
<li>自动内存管理</li>
<li>自动垃圾回收机制</li>
</ol>
<h4><span id="虚拟机在计算机中的位置">虚拟机在计算机中的位置</span></h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224094303154.png" alt="image-20210224094303154"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224094516957.png" alt="image-20210224094516957"></p>
<h3><span id="其他">其他</span></h3><p>OpenJDK  半年更新一次  维护半年  之后不再维护 免费开源</p>
<p>OracleJDK  维护期三年  付费 内容稍微少一些</p>
<p>两者在代码的实质上基本一致</p>
<h2><span id="正式进入">正式进入</span></h2><h3><span id="java代码的执行流程">Java代码的执行流程</span></h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224095237677.png" alt="image-20210224095237677"></p>
<h3><span id="jvm的架构">JVM的架构</span></h3><p>Java编译器输入的指令流是 一种<strong>基于栈的指令集架构</strong>   不是基于寄存器的指令集架构</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224095537650.png" alt="image-20210224095537650"></p>
<h3><span id="jvm的生命周期">JVM的生命周期</span></h3><ol>
<li>启动： bootstapclass loader引导类加载器创建的初始类 initial class 完成的 (加载父类？？)</li>
<li>执行：一个虚拟机对应着执行一个Java程序</li>
<li>退出：异常 、 正常执行完毕、操作系统错误、exit方法</li>
</ol>
<h2><span id="类加载">类加载</span></h2><h3><span id="classloader">ClassLoader</span></h3><p>只负责class 文件的加载，至于是否能运行，由Execution Engine决定</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224152835665.png" alt="image-20210224152835665"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224153411382.png" alt="image-20210224153411382"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224163801377.png" alt="image-20210224163801377"></p>
<h3><span id="加载loading">加载Loading：</span></h3><ol>
<li>通过类的全限定名获取定义此类的二进制字节流</li>
<li>将该字节流代表的静态存储结构转化为方法的运行时数据</li>
<li>内存中生成一个代表此类的 java.lang.Class对象，作为方法区这个类的各个数据的访问入口</li>
</ol>
<h3><span id="链接linking阶段">链接Linking阶段：</span></h3><h4><span id="验证-verify">验证 Verify</span></h4><p>确保Class文件的字节流一中包含信息符号当前的虚拟机要求，保证<strong>加载类的正确性</strong>，不危害虚拟机自身安全。</p>
<p>文件格式验证 元数据验证  字节码验证 符号引用验证</p>
<h4><span id="准备-prepare">准备 Prepare</span></h4><p>为类变量分配内存并且设置该内变量的默认初始值，哪怕是a = 1 最开始也是  a=0</p>
<p>不包含用final修饰的static  final在编译阶段就会分配了</p>
<h4><span id="解析-resolve">解析 Resolve</span></h4><p>将常量池内的符号引用转换为直接引用的过程</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228145418046.png" alt="image-20210228145418046"></p>
<h3><span id="类的初始化">类的初始化</span></h3><p>执行类构造器方法 clinit  的过程</p>
<p>javac 编译器自动收集类中的所有<span style="color:red;">类变量</span>的<strong>赋值动作</strong>和<strong>静态代码块中语句</strong>合并而来</p>
<p>有静态语句 或者 静态变量 就会有 clinit 方法      不包含主方法</p>
<p>clinit 方法一定是先执行父类的 clinit 在进行子类的clinit</p>
<p>虚拟机必须保证一个雷的clinit 方法咋多线程下被同步加锁</p>
<p>static 代码块 和 static变量的赋值 有顺序的关系，那个在后 那个后执行，但是可以在static语句块中赋值再定义 ——有一个注意点  非法的前向引用（可以赋值但不能调用）</p>
<h5><span id="变量初始化过程">变量初始化过程</span></h5><p>默认初始化–显示初始化- -构造器初始化–对象.属性的初始化</p>
<h3><span id="加载器的分类">加载器的分类</span></h3><h4><span id="bootstapclassload">BootStapClassLoad</span></h4><ul>
<li>用c/c++实现 嵌套在JVM内部</li>
<li>不继承ClassLoader </li>
</ul>
<p>系统的核心类库都是用引导类加载器加载的</p>
<p>不能直接通过getClassLoader获取</p>
<h4><span id="appclassloader">AppClassLoader</span></h4><p>加载环境变量classpath和系统属性 java.class.path  是程序中的<strong>默认类加载器</strong> </p>
<h4><span id="extensionloader">ExtensionLoader</span></h4><p>从java.ext.dirs系统属性指定的目录中加载类库</p>
<h4><span id="自定义类加载器">自定义类加载器</span></h4><p>目的：</p>
<ul>
<li>隔离加载类</li>
<li>修改类加载的方式</li>
<li>扩展加载源</li>
<li>防止源码泄露</li>
</ul>
<h2><span id="双亲委派机制">双亲委派机制</span></h2><p>问题引入：</p>
<p>自己创建 的 java.lang.String 和原生的冲突 会先加载原来的</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224173500988.png" alt="image-20210224173500988"></p>
<ol>
<li>一个雷加载器收到了类加载请求，他并不会自己先加载，而是把这个请求委托给父类的加载器执行。</li>
<li>一次递归请求最终到达顶层的启动类加载器</li>
<li>如果父类的加载器无法加载（引导类加载器和拓展类加载器只加载指定目录的class），才会委派给子类的加载器加载</li>
</ol>
<h3><span id="优点">优点</span></h3><ol>
<li>保护程序安全，避免核心API被更改</li>
<li>避免类的重复加载 </li>
</ol>
<h2><span id="沙箱安全机制">沙箱安全机制</span></h2><p>沙箱安全机制是由基于双亲委派机制上 采取的一种JVM的自我保护机制,假设你要写一个java.lang.String 的类,由于双亲委派机制的原理,此请求会先交给Bootstrap试图进行加载,但是Bootstrap在加载类时首先通过包和类名查找rt.jar中有没有该类,有则优先加载rt.jar包中的类,因此就保证了java的运行机制不会被破坏.</p>
<p>虚拟机会把所有代码加载到不同的系统域和应用域，系统域部分专门负责与关键资源进行交互，而各个应用域部分则通过系统域的部分代理来对各种需要的资源进行访问。虚拟机中不同的受保护域 (Protected Domain)，对应不一样的权限 (Permission)</p>
<h2><span id="其他">其他</span></h2><p>JVM中判断两个class对象是否是同一个类存在的两个条件</p>
<ol>
<li>类的完整名称必须一致</li>
<li>加载这个类的加载器必须相同</li>
</ol>
<h3><span id="类的主动使用和被动使用">类的主动使用和被动使用</span></h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224184726345.png" alt="image-20210224184726345"></p>
<h2><span id="运行时数据区">运行时数据区</span></h2><p>RunTime Data Area        桥梁: CPU  — 内存 —- 硬盘 </p>
<p>不同的JVM对内存的划分方式和管理机制存在差异</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210225201740198.png" alt="image-20210225201740198"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210225201756298.png" alt="image-20210225201756298"></p>
<p><strong><span style="color:red;">红色 </span> 一个进程一份</strong></p>
<p><strong>灰色  一个线程一份</strong></p>
<p><span style="color:red;"> 一个JVM实例对应一个RunTime实例</span></p>
<p>HotSpot JVM每个线程对应操作胸膛的本地线程直接映射</p>
<h3><span id="虚拟机栈">虚拟机栈</span></h3><h4><span id="概念">概念</span></h4><p>内部保存一个个的栈帧，对应着一次次的java方法调用（线程私有）</p>
<ul>
<li><p>生命周期和线程一致</p>
</li>
<li><p>栈是运行时单位，堆是存储单位</p>
</li>
</ul>
<p>作用：主管java程序的运行，保存方法的局部变量，部分结果，参与方法的调用和返回</p>
<p>优点： 访问速度快  <strong>不存在垃圾回收问题</strong> <strong>GC</strong>   (只有进栈出栈操作) 但可能存在OOM</p>
<p>设置栈大小 VMOptions: -Xss256k</p>
<h4><span id="异常">异常</span></h4><ul>
<li>JVM允许java栈大小是动态或者固定的</li>
<li>栈溢出异常： 线程的请求分配的栈容量超过JAVA虚拟机允许的最大容量，将抛出Stack Overflow异常</li>
<li>OOM： 动态扩展时没有足够的内存去申请或者创建，则跑出OutofMemoryError异常</li>
</ul>
<h4><span id="栈帧">栈帧</span></h4><p>栈中的数据都是以栈帧方式存在的，每个方法都对应一个栈帧</p>
<p>当前栈帧：当前执行方法。</p>
<p> 不同线程的栈帧是不允许相互引用的，不能在一个线程的方法里去调用另一个线程中的方法                                                    </p>
<p>包含：</p>
<h5><span id="局部变量表">局部变量表</span></h5><p>(基本决定栈帧的大小)</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228084320963.png" alt="image-20210228084320963"></p>
<ul>
<li><p>数字数组，存储方法参数和定义在方法体内的局部变量。包含基本数据类型，对象引用  （<strong>byte short boolean char 被转换为int</strong>），返回值类型</p>
</li>
<li><p><span style="color:red;font-size:24px">垃圾回收的重点内容</span></p>
</li>
<li><p>所需大小是编译器确定下来的。未被赋值的声明是不会列入局部变量表的slot，但会列入locals(maximum local variables)中</p>
</li>
<li><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228090243915.png" alt="image-20210228090243915"></p>
</li>
<li><p>Slot  槽：局部变量表的基本单位</p>
<ul>
<li>32位以内的类型只占用一个slot <strong>64位占用两个slot，在locals中看得出来</strong><ul>
<li>在外部方法中引用该类中对象或者方法时（不引用也会有） slot index0 位置会保存类的对象引用this</li>
<li>slot中的变量存在<strong>重复利用</strong>，内部域变量过期后的slot位置将由外部遍历替代        </li>
<li>局部变量初始化后再使用时必须赋值，否则编译不通过                                     </li>
</ul>
</li>
</ul>
</li>
</ul>
<h5><span id="操作数栈">操作数栈</span></h5><p>数组、链表实现 FILO</p>
<p>作用：根据字节码指令，在栈中写入数据，入栈和出栈，保存计算过程的中间结果</p>
<ul>
<li>a + b = c实例</li>
</ul>
<h6><span id="代码解析">代码解析</span></h6><p>bipush: 这里的 bi 代表byte 的整型，与代码中定义的int byte类型无关，他只与结果的具体数值有关，转换成最接近的类型]</p>
<p>istore:将push的byte值转换为java中类型对应的int值</p>
<p>注意这里istore_0和istore_1的区别，如果是主方法或者普通方法时，要么保存的是对象的引用this 要么就是args参数在index 为0位置。如果是类的静态方法中时，则就不存在其他的数据，一个数据都保存在index0处</p>
<p>iconst：当int取值**-1~5<strong>时，JVM采用</strong>iconst**指令将常量压入栈中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0: bipush        10</span><br><span class="line">     2: istore_1</span><br><span class="line">     3: bipush        20</span><br><span class="line">     5: istore_2</span><br><span class="line">     6: iload_1</span><br><span class="line">     7: iload_2</span><br><span class="line">     8: iadd</span><br><span class="line">     9: istore_3</span><br><span class="line">    10: return</span><br></pre></td></tr></table></figure>

<ul>
<li>每个操作数栈都拥有一个明确的栈深度存储数值，编译器就定义好</li>
</ul>
<p>Code — max_stack中 </p>
<ul>
<li>栈占用单位同slot</li>
<li>操作数栈中存在复用 </li>
<li>如果被调用的方法中带有返回值的话，其返回值将会被压入当前栈帧操作数栈中，并更新pc寄存器中的指令</li>
</ul>
<h6><span id="栈顶缓存技术">栈顶缓存技术</span></h6><p>出发点：栈结构，频繁执行内存读写（出栈入栈）</p>
<p>栈顶元素全部缓存在cpu寄存器中，提升执行引擎的效率</p>
<h5><span id="动态链接">动态链接</span></h5><p>——运行时常量池的方法引用</p>
<p>每一个栈帧内部都包含一个指向<strong>运行时常量池</strong>中该栈帧所属方法的引用</p>
<p>目的：支持当前方法的代码能够实现动态链接，将保存变量和方法引用的符号引用转换为调用方法的直接引用</p>
<h6><span id="方法的调用">方法的调用</span></h6><p>静态链接和动态链接</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228141739834.png" alt="image-20210228141739834"></p>
<p>静态链接：目标方法在编译期间可知且运行期保持不变，这种情况下降调用方法的符号应用转换为直接引用的过程称为静态链接</p>
<p>动态链接：编译时无法确定</p>
<p>方法的绑定机制：早期绑定和晚期绑定</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228142033732.png" alt="image-20210228142033732"></p>
<p>晚期绑定：</p>
<p>多态、继承，无法确定  —-invokeVirtual</p>
<p>早期绑定：</p>
<p>invokeSpecial</p>
<p>虚方法：</p>
<p>非虚方法：</p>
<ul>
<li><p>编译期间确定版本，运行时不可变</p>
</li>
<li><p>静态方法、私有方法、final方法、示例构造器、父类方法</p>
</li>
</ul>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228143133793.png" alt="image-20210228143115307"></p>
<p>在子类中未显示的调用父类方法是虚方法（可能子类进行了重写）</p>
<p><span style="font-size:24px;color:orange">动态类型和静态类型语言的区别</span></p>
<p>对类型的检查是在编译期间还是在运行期间</p>
<ul>
<li><p>前者判断变量自身的类型信息  </p>
</li>
<li><p>后者判断变量值的类型信息，变量是没有类型信息的（JavaScript）</p>
</li>
</ul>
<p><span style="font-size:24px;color:orange">虚方法表</span></p>
<p>目的： 避免自下而上频繁的使用动态分配</p>
<p>创建阶段： linking</p>
<p>每个类中都有一个虚方法表</p>
<h5><span id="方法返回地址">方法返回地址</span></h5><p>方法正常退出的定义（异常退出时由异常表决定）</p>
<p>存放调用该方法的<strong>pc寄存器</strong>的值 类似ret？？？</p>
<p><span style="font-size:18px;color:cyan">异常处理表</span></p>
<p>class文件中   from  to  target</p>
<p>异常完成出口不会给上层调用者任何返回的信息</p>
<h5><span id="附加信息">附加信息</span></h5><h3><span id="本地方法栈">本地方法栈</span></h3><ul>
<li>线程私有</li>
<li>内存 固定或者动态扩展</li>
<li>本地方法用C语言实现</li>
<li>实现：虚拟机栈中登记本地方法</li>
</ul>
<p>当线程调用本地方法时，就进入了一个全新的不受虚拟机限制的 世界，和虚拟机有相同的权限</p>
<p>本地方法通过本地方法接口访问虚拟机内部运行时数据区</p>
<h4><span id="本地方法接口和库">本地方法接口和库</span></h4><p>Native Method : Java 调用非Java代码</p>
<h3><span id="程序计数器">程序计数器</span></h3><p>用来存储指向下一条指令的的<strong>字节码</strong>地址( ProgramCounter Register)</p>
<ul>
<li><p>很小的内存空间，运行速度最快</p>
</li>
<li><p>线程私有，生命周期和线程的生命周期保持一致</p>
</li>
<li><p>存储当前线程正在执行方法的JVM指令地址 如果执行native方法则是未指定值</p>
</li>
<li><p>唯一一个在JVM规范中没有规定任何OOM情况的区域</p>
</li>
<li><p>线程分支循环跳转异常处理、恢复等基础功能都需要依赖他</p>
</li>
</ul>
<h4><span id="pc寄存器的好处">PC寄存器的好处</span></h4><p>CPU会不停切换线程，切换回来以后不知道从那开始执行</p>
<p>指明当前执行代码的字节码指令</p>
<h4><span id="cpu时间片">CPU时间片</span></h4><ul>
<li><p>CPU分配给各个程序的时间</p>
</li>
<li><p><strong>CPU主频高，不断的切换，感觉像是在并行（不是并发）的执行</strong>——-这就叫并发</p>
</li>
<li><p>一个内核一时刻只能执行一条指令</p>
</li>
</ul>
<h3><span id="堆">堆</span></h3><p>一个JVM只存在一个堆内存      一个进程对应一个堆，JVM启动时 堆被创建  其空间大小就确定了   ，但堆内存的大小是可以调节的</p>
<p>堆可以处于物理上不连续的空间，但逻辑上他是连续的</p>
<p>所有的线程共享JAVA堆，还可以划分线程私有的华冲去   TLAB  THREAD LOCAL ALLOCATION BUFFER</p>
<p><strong>所有的对象实例及数组都应在运行时分配到堆上</strong></p>
<ul>
<li>方法结束后，堆的对象不会马上被移除，仅仅在垃圾收集时才会被移除（判断是否有引用）</li>
<li>堆是 GC 执行垃圾回收的重点区域</li>
</ul>
<h4><span id="堆空间细分逻辑上">堆空间细分（逻辑上）</span></h4><ul>
<li>Java 7 新生区  养老区  永久区</li>
</ul>
<ul>
<li>Java 8  包括以后   新生区  养老区  元空间</li>
</ul>
<h4><span id="设置堆空间大小">设置堆空间大小</span></h4><p>-Xms   堆区（新生代+老年代）的起始内存</p>
<p>-Xmx    堆区最大内存</p>
<p>-X JVM运行参数    -ms memory start</p>
<p>JVM 参数地址</p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html">https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html</a></p>
<p>初始大小   电脑内存 / 64     默认大小  电脑内存 / 4</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Runtime.getRuntime().totalMemory()</span><br></pre></td></tr></table></figure>

<p><span style="color:red;font-size:18sp">问题： 设置Xms为10m  为什么得到的内存&lt;10</span></p>
<ul>
<li>Eden 区 只能和Survivor 1 或 2区 进行存储  而不是两个Survivor区都可以存储</li>
</ul>
<h4><span id="堆空间的oom">堆空间的OOM</span></h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210302163155472.png" alt="image-20210302163155472"></p>
<h4><span id="年轻代与老年代">年轻代与老年代</span></h4><p>YoungGen</p>
<p>占比1 / 3</p>
<ul>
<li>Survivor 0 ： from区</li>
<li>Survivor 1 ：to区</li>
</ul>
<p>OldGen</p>
<p>​    占比2 / 3</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210302163141130.png" alt="image-20210302163141130"></p>
<p>默认比例</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210302163437852.png" alt="image-20210302163437852"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210302163456336.png" alt="image-20210302163456336"></p>
<p><span style="color:red;font-size:18sp">问题： Eden和Survivor比例是 8:1  但实际是 6:1？</span></p>
<ul>
<li>自适应机制   -XX:-UseAdaptiveSizePolicy 关闭自适应的内存分配</li>
<li>可通过 -XX:SurvivorRatio 调整</li>
</ul>
<p><span style="color:orange;font-size:24px">几乎所有的Java对象都是Eden区 中new出来的</span></p>
<h4><span id="对象分配过程">对象分配过程</span></h4><p><span style="color:#00CD66;font-size:18px">YoungGC     Minor GC</span></p>
<ol>
<li>new的对象先到Eden区</li>
<li>Eden区被填满后  JVm GC器对 Eden区进行垃圾回收 MinorGC  销毁没有引用的对象 </li>
<li>将Eden的剩余对象移动到Survivor 0 区 并加上age 1</li>
<li>再次触发GC时  上次放到Seurvivor 0 区的就会 进入 1 区 age ++</li>
<li>阈值 age &gt;15 时 到 Old Gen 区  <span style="color:red;font-size:18sp">也有可能破格晋升</span></li>
</ol>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303084331819.png"></p>
<p><strong>注意点</strong></p>
<ul>
<li><p>Eden区满 会将 Eden 和Survivor 区一起进行回收</p>
</li>
<li><p>Survivor区满不会进行回收！Survivor放不下，直接晋升老年代</p>
</li>
<li><p>0区 和1区复制之后有交换，谁空谁是to区</p>
</li>
<li><p>动态对象年龄判断</p>
<p>如果Survivor 中相同年龄的所有对象大小的总合大于 该区空间的一半，则年龄大于或等于该年龄的对象直接进入老年代(优化)</p>
</li>
<li><p>大对象直接放入老年代 (优化)</p>
</li>
</ul>
<h4><span id="minor-gc-major-gc-full-gc">Minor GC、Major GC 、Full GC</span></h4><p>STW  ： stop the world</p>
<ul>
<li><p>部分收集  Partial GC:</p>
<ul>
<li><p>Minor GC :</p>
<ul>
<li>执行频率高，速度快触发 STW 暂停用户线程  </li>
</ul>
</li>
<li><p>Major GC:</p>
<ul>
<li>执行速度比minor GC慢10倍以上  STW时间更长</li>
<li>老年代空间不足，先尝试minor GC如果还不足，就触发Major GC</li>
</ul>
</li>
<li><p>Mixed GC: 收集整个新生代和部分老年代的垃圾</p>
</li>
</ul>
</li>
<li><p>整堆收集 Full GC： 收集整个java堆和方法区的垃圾</p>
<ul>
<li>调优中尽量避免</li>
<li>触发条件：<ol>
<li>老年代空间不足</li>
<li>方法区空间不足</li>
<li>System.gc()但不一定执行</li>
<li>MinorGC进入老年代的平均大小大于老年代的可用内存</li>
<li>Survivor区转存到老年代时可用内存小于该对象大小</li>
</ol>
</li>
</ul>
</li>
</ul>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303160142447.png" alt="image-20210303160142447"></p>
<p><span style="color:red;font-size:18px">为什么要分代</span></p>
<ul>
<li>优化GC性能   缩小对堆的扫描范围</li>
</ul>
<h4><span id="tlab">TLAB</span></h4><p>问题：堆区是线程共享区域    并发环境下从堆区划分内存空间是线程不安全的</p>
<p>定义： 每个线程中独有一份TLAB  即私有缓存区域</p>
<p>目的：</p>
<ul>
<li>多线程分配内存，能避免一系列的非线程安全问题</li>
<li>提升内存分配的吞吐量（快速分配策略）</li>
</ul>
<p>JVM将TLAV作为内存分配的首选</p>
<p>TLAB空间小  仅仅占整个Eden的1% ,  也可以设置</p>
<p>一旦对象在TLAB空间分配内存失败，JVM尝试使用加锁机制确保数据操作的原子性，进而在Eden空间分配内存</p>
<h4><span id="逃逸分析">逃逸分析</span></h4><p>将堆上的对象分配到栈    </p>
<ul>
<li>对象在<strong>方法内部中定义</strong>后  只 在内部使用， 则没有逃逸   ——&gt;使用栈上分配</li>
<li>对象在<strong>方法内部定义</strong>后  被外部方法所引用 。则发生了逃逸</li>
</ul>
<p><span style="color:red;font-size:18px">如何判断是否发生逃逸</span></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303161641422.png" alt="image-20210303161641422"></p>
<p>优化  前提 未发生逃逸</p>
<h5><span id="栈上分配">栈上分配</span></h5><p>原理 ？？</p>
<p>实例n个对象时，开启栈上分配， 速度大幅提高，实例数降低。</p>
<h5><span id="同步省略">同步省略</span></h5><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303162647795.png" alt="image-20210303162647795"></p>
<p>去除了同步操作</p>
<h5><span id="代码优化">代码优化</span></h5><p>分离对象或者标量替换   肢解</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303163208358.png" alt="image-20210303163208358"></p>
<h3><span id="元空间">元空间</span></h3><p>永久代 —&gt;方法区 —–&gt;元空间</p>
<p>固定大小或者动态变化   自动收缩   逻辑上连续 物理上不连续</p>
<p>逻辑上属于堆的一部分</p>
<p><span style="color:#018531;font-size:30px">方法区用于存储已被虚拟机加载的类型信息、常量、静态常量、即时编译器（JIT）编译后的代码缓存….</span></p>
<p><span style="color:orange;font-size:18px">方法区看做是一块独立于Java堆的内存空间</span></p>
<p><span style="color:orange;font-size:18px">方法区的大小决定了系统可以保存多少个类，如果系统定义了太多的类，方法区会溢出 抛出OOM</span></p>
<p><span style="color:#4169E1;font-size:18px">元空间和永久代最大的区别</span></p>
<p>元空间不在虚拟机的内存中，而是在本地内存 ，内部结构也发生改变</p>
<h4><span id="方法区-堆-栈的交互关系">方法区 堆  栈的交互关系</span></h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303164007274.png" alt="image-20210303164007274"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303164100411.png" alt="image-20210303164100411"></p>
<h4><span id="设置元空间大小">设置元空间大小</span></h4><p>-XX: MataSpaceSize=     设置初始分配空间 默认20.75M    </p>
<p>-XX：MaxMataSpaceSize  设定最大可分配控件   32位默认64M  64位默认82M    设置为-1则没有限制</p>
<p>JDK1.7以前    -PermSize</p>
<p>常用指令  jps  jinfo -flag   xxxxx aaaa</p>
<p>触及21M  FULL GC 释放没用的类，水位线重置，如果释放空间过多，则降低该值</p>
<p><span style="color:orange;font-size:18px">内存泄露和内存溢出</span></p>
<p>内存泄露   病人康复 但是占着床位</p>
<p>内存溢出  病人太多，床位不够</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303171142462.png" alt="image-20210303171142462"></p>
<h4><span id="内部结构">内部结构</span></h4><h5><span id="类型信息">类型信息</span></h5><p>完整有效名称    直接父类的完整有效名称    修饰符     直接接口的有序列表</p>
<h5><span id="方法信息">方法信息</span></h5><h5><span id="域信息">域信息</span></h5><p>域名称、域类型、域修饰符   </p>
<p><strong>注意：如果是private类型的话，是看不到域信息的</strong></p>
<h5><span id="non-final类变量">non-final类变量</span></h5><p>静态变量 在实例对象为null的情况下依然可以访问对象中的静态方法或者字段</p>
<h5><span id="全局常量">全局常量</span></h5><p>编译时分配   (准备阶段)</p>
<p><span style="color:orange;font-size:18px">与静态变量比较</span></p>
<p>静态变量在准备阶段初始化  在initial阶段赋值   也就是在静态语句中 clinit类构造器方法中赋值。而全局变量则不会再这个阶段赋值</p>
<h4><span id="运行时常量池">运行时常量池</span></h4><h5><span id="字节码的常量池">字节码的常量池</span></h5><p>存储各种字面量和对类型、方法和域的符号引用</p>
<p>类引用、字段引用、方法引用、数量值、字符串值</p>
<p>将在类加载后存放到方法区的运行时常量池中，这时符号地址就转换为了真实地址</p>
<h5><span id="动态性">动态性</span></h5><p>与常量池的差别</p>
<h5><span id="jdk161718的调整">JDK1.6–1.7–1.8的调整</span></h5><p><span style="color:red;font-size:24px">为什么要用元空间替代永久代？</span></p>
<ol>
<li>为永久代设置空间大小是很难确定的</li>
<li>对永久代的调优很困难</li>
</ol>
<p>静态变量的位置  </p>
<p>1.6–1.7 对象的引用名放在Old Gen中  1.8 在堆中  ？</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210304150244295.png" alt="image-20210304150244295"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210304150705423.png" alt="image-20210304150705423"></p>
<p>只要是实例对象 必然会在Java堆中分配</p>
<h5><span id="垃圾回收">垃圾回收</span></h5><p>回收内容：</p>
<p>常量池中废弃的常量和不再使用的类型</p>
<p>苛刻条件： 判断一个类已经被废弃</p>
<p><strong>总结</strong></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210304145524447.png" alt="image-20210304145524447"></p>
<h2><span id="对象的实例化面试">对象的实例化(面试)</span></h2><h3><span id="对象的实例化">对象的实例化</span></h3><ol>
<li>new</li>
<li>class.newInstance / constructor.new Instance  反射的方式<ul>
<li>只能调用空参的构造器，权限必须是public</li>
<li>constructor的newInstance 调用空参或者带参数的构造器，权限没有要求</li>
</ul>
</li>
<li>clone()<ul>
<li>需要实现Cloneable接口</li>
</ul>
</li>
<li>反序列化<ul>
<li>网络中获取对象的二进制流</li>
</ul>
</li>
<li>第三方库Objenesis</li>
</ol>
<h3><span id="对象创建步骤">对象创建步骤</span></h3><p>字节码中</p>
<p>new #x</p>
<p>分配内存、初始化值</p>
<p>dup ：Duplicate the top value on the operand stack and push the duplicated value onto the operand stack.  复制操作数堆栈上的顶值，并将复制的值推送到操作数堆栈上。</p>
<p>invokespecial #a</p>
<p>调用init构造器    </p>
<p><span style="color: #DAA520;font-size:24px">流程</span></p>
<ol>
<li>判断对象对应的类是否加载、连接、初始化，（是否有符号引用）</li>
</ol>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307084406633.png" alt="image-20210307084406633"></p>
<ol start="2">
<li>为对象分配内存</li>
</ol>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307084458998.png" alt="image-20210307084458998"></p>
<ul>
<li><p>如果内存规整  ——&gt; 指针碰撞</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307084643494.png" alt="image-20210307084643494"></p>
</li>
<li><p>内存不规整  —–&gt;虚拟机需要维护一个列表    空闲列表分配</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307084721903.png" alt="image-20210307084721903"></p>
</li>
</ul>
<ol start="3">
<li><p>处理并发问题</p>
<p>CAS 失败重试  区域加锁保证更新的原子性</p>
<p>每个线程预先分配一个TLAB   </p>
</li>
<li><p>初始化分配空间</p>
<p>所有属性值默认值，保证对象实例字段在不赋值时可以直接使用</p>
</li>
<li><p>设置对象的对象头</p>
</li>
<li><p>init方法进行初始化  —-&gt;赋值</p>
</li>
</ol>
<h3><span id="对象的内存布局">对象的内存布局</span></h3><p>大厂面试</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307090815341.png" alt="image-20210307090815341"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307090828271.png" alt="image-20210307090828271"></p>
<h4><span id="对象头">对象头</span></h4><ol>
<li>运行时源数据 Mark Work<ol>
<li>哈希值</li>
<li>GC分代年龄</li>
<li>锁状态标志</li>
<li>线程持有的锁</li>
<li>偏向线程ID</li>
<li>偏向时间戳</li>
</ol>
</li>
<li>类型指针  指向类元数据，确定该对象的所属属性</li>
</ol>
<h4><span id="实例数据">实例数据</span></h4><h4><span id="instance-data">Instance Data</span></h4><p>对象真正存储的有效信息，包括程序代码定义的各种类型的字段</p>
<p>规则： 入少年宫图</p>
<h4><span id="对齐填充">对齐填充</span></h4><p>占位符作用</p>
<p>64位 JVM   实际对象必须是8的整数位   只有1byte属性也要给你整到 16 bytes</p>
<p>一个空的对象</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405171441583.png" alt="image-20210405171441583"></p>
<p>两个String属性的对象</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405171535161.png" alt="image-20210405171535161"></p>
<p>网上说的  32bit  4 byte</p>
<p>故  对象头字节固定 为 12 字节</p>
<p><strong>对象头由什么组成</strong>？</p>
<ol>
<li><p>MarkWord   64 bit</p>
<p>存储对象的hashCode、锁信息或分代年龄或GC标志等信息</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405190427725.png" alt="image-20210405190427725"></p>
</li>
<li><p>Class Meta Address  32/64  bit(开启指针压缩</p>
<p>类型指针指向对象的类元数据，JVM通过这个指针确定该对象是哪个类的实例</p>
</li>
</ol>
<p>小端存储 / 大端存储   </p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405184732813.png" alt="image-20210405184732813"></p>
<p><strong>对象状态</strong>：</p>
<ol>
<li>无状态  new时</li>
<li>偏向锁</li>
<li>轻量</li>
<li>重量锁</li>
<li>gc标记（无引用）</li>
</ol>
<h4><span id="总结图示">总结图示</span></h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307091320160.png" alt="image-20210307091320160"></p>
<h3><span id="对象访问定位">对象访问定位</span></h3><p>JVM通过栈帧中的对象引用访问到内部的对象实例</p>
<h4><span id="访问方式">访问方式</span></h4><ol>
<li><p>句柄访问</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307091748884.png" alt="image-20210307091748884"></p>
<ul>
<li>空间浪费</li>
<li>稳定  发生移动时外部指向不需要修改</li>
</ul>
</li>
<li><p>直接指针 HotSpot使用</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307091828272.png" alt="image-20210307091828272"></p>
<ul>
<li>发生移动时 外部reference需要修改指向的地址</li>
</ul>
</li>
</ol>
<h2><span id="直接内存">直接内存</span></h2><p>基于元空间</p>
<p>Java堆外，向系统申请的内存空间</p>
<p>来源于NIO，世界使用DirectByteBuffer</p>
<p>NIO ：Non-Blocking IO  免去中间商</p>
<p>访问直接内存的速度，优于Java堆</p>
<p>缺点：</p>
<ul>
<li>分配回收成本高</li>
<li>不受JVM内存回收管理</li>
</ul>
<p>OOM  设置： MaxDirectMemorySize</p>
<p>不知道，则与堆的最大值 -Xmx参数值一致</p>
<h2><span id="执行引擎">执行引擎</span></h2><h3><span id="概述">概述</span></h3><p>物理机的执行引擎：</p>
<p>直接建立在处理器、缓存、指令集和操作系统层面上</p>
<p>JVM的执行引擎：</p>
<p>虚拟机的执行引擎，由软件自行实现，不受物理条件制约定值指令集和执行引擎的结构体系，能执行不受硬件直接支持的指令集格式</p>
<p><span style="color:orange;font-size:24px">JVM主要任务</span></p>
<p>字节码文件加载到内存中并<strong>解释执行</strong>， 解释/编译为对应平台上的本地机器指令</p>
<ul>
<li>执行引擎的执行的字节码指令完全依赖于PC寄存器</li>
</ul>
<h3><span id="java代码编译-执行的过程">Java代码编译、执行的过程</span></h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307094756146.png" alt="image-20210307094756146"></p>
<p><span style="color:orange;font-size:24px">橙色与java虚拟机无关</span></p>
<p><span style="color:#FA8072;font-size:24px">解释器 Interpreter</span></p>
<p>根据预定义的规范对字节码采用逐行解释的方式执行</p>
<p><span style="color:#FA8072;font-size:24px">编译器 Just In Time Compiler编译器</span></p>
<p>JVM将原码编译成和本地机器平台相关的机器指令</p>
<p><span style="color:red;font-size:24px">为什么Java是半编译半解释语言</span></p>
<p><span style="color: #00BFFF;font-size:18px">JVM执行代码时将解释执行和编译执行两者结合起来进行</span></p>
<p><span style="color:#3CB371;font-size:24px">字节码是一种中间状态的二进制代码，比机器码抽象，需要直译器转译后才能成为机器码</span></p>
<p>为了实现特定软件运行和软件环境，和硬件环境无关</p>
<p>编译器将源码编译成字节码， 虚拟机器将字节码转译可以直接执行的指令</p>
<h3><span id="解释器的使用">解释器的使用</span></h3><p>为什么要加入字节码？</p>
<p>为什么不直接搞成JVM？   分割工作</p>
<p>解释器发展历史：</p>
<p>字节码解释器  效率低下，逐行翻译 </p>
<p>模板解释器  每条字节码和模板函数相关，模板函数直接产生这条字节码执行的机器码  提高性能</p>
<p>基于解释器执行： 低效</p>
<h3><span id="即时编译-jit编译器">即时编译  JIT编译器</span></h3><p>避免数被解释执行，将整个函数体编译成机器码    速度快</p>
<p><span style="color:#FA8072;font-size:24px">HotSpot采用的是解释器与即时编译器并存的架构，互相协作取长补短，选择最合适的方式去权衡编译本地代码</span></p>
<p>JVM启动时，解释器首先发挥作用，随着程序时间推移，JIT编译器逐渐发挥作用，热点探测，将有价值的字节码编译为本地机器指令，以换取更高的执行效率</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307215507412.png" alt="image-20210307215507412"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307220023296.png" alt="image-20210307220023296"></p>
<h4><span id="热点代码和探测方式">热点代码和探测方式</span></h4><p>何时使用JIT 编译器？ </p>
<p>针对运行时频繁调用的热点代码进行深度优化，直接编译为对应平台的本地机器指令   —–栈上替换 OSR</p>
<p>热点探测功能</p>
<p>基于计数器</p>
<p>JVM为每个方法建立2个不同的计数器  </p>
<ul>
<li><p>方法调用计数器   </p>
<p>统计方法的调用次数</p>
<p>阈值 1500 / 10000 次</p>
<p>-XX: CompileThreshold</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307220456220.png"></p>
<p><span style="color: #DA70D6;font-size:24px">热度衰减</span></p>
<p>方法调用计数器统计的部署绝对次数，而是相对的执行效率，超过一定时间线度，如果调用次数仍然不足则会减少一半   ，半衰周期</p>
<p>-XX: UseCounterDecay  关闭热度衰减</p>
<p>-XX： CounterHalfLifeTime 设置半衰期时间   s</p>
</li>
<li><p>回边计数器   统计循环体执行的循环次数</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307220949310.png" alt="image-20210307220949310"></p>
</li>
</ul>
<p>修改HotSpot的编译模式,会发生实质的时间变化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> s = System.currentTimeMillis();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> e = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">&quot;==========&quot;</span> + (e-s));</span><br></pre></td></tr></table></figure>

<p>-Xcomp    即时编译 3759</p>
<p>-Xint     解释编译  9802</p>
<p>-Xmixed    3847  </p>
<p>可以看出，使用混合编译 和 即时编译模式下，相差不大，但解释编译时很慢且相差很大</p>
<p>HotSpot有 两个Jit 编译器  C1 和  C2  </p>
<ul>
<li><p>64位版本  JVM 默认 是-server模式  使用C2  耗时较长的优化，激进优化，优化的代码执行效率更高</p>
</li>
<li><p>-client 模式，C1编译器，  对字节码进行简单和可靠的优化，耗时短， 更快的编译速度</p>
</li>
</ul>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307222415561.png" alt="image-20210307222415561"></p>
<p>分层编译策略</p>
<h3><span id="graal编译器和aot编译器">Graal编译器和AOT编译器</span></h3><p>AOT Ahead Of Time Compiler  程序运行之前，将字节码转换为机器吗  与JIT 编译器对比</p>
<h2><span id="stringtable">StringTable</span></h2><h3><span id="基本特性">基本特性</span></h3><p>不可变性  实现Serializebale接口 之处序列化   实现Comparable接口 可比较大小</p>
<p>JDK 8 后用的是char[]数组存储， JDK9之后使用byte[] + 编码标识存储</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308080434960.png" alt="image-20210308080434960"></p>
<ul>
<li>在方法内部通过形参传递String对象， 内部改变，外部不会改变</li>
<li>底层是固定大小的HashTable  默认长度是1009，String 多时，Hash冲突，链表很长，影响String.intern</li>
<li>-XX:tringTableSize 调整长度</li>
<li>jdk 7 中默认长度是 60013</li>
<li>jdk8 长度要求最小值是1009</li>
<li>提高map长度，能够在一定程度提高String存储的效率</li>
</ul>
<h3><span id="string的内存分配">String的内存分配</span></h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308082215487.png" alt="image-20210308082215487"></p>
<p><span style="color:red;font-size:24px">为什么Stringtable要调整</span></p>
<p>permsize默认比较小</p>
<p>永久代垃圾回收频率低</p>
<p><strong>编译期优化</strong></p>
<p><span style="color:orange;font-size:24px">如果拼接的符号前后出现了变量(不是常量)，则相当于在对空间中new String 地址就不一样了</span></p>
<p>String s2= s1+”123” != String s3 = s1 +s4;</p>
<p>String s3 = s1 +s2  字节码原理</p>
<p>new StringBuilder   调用的是append方法 append(s1)—&gt; append(s2) —&gt;StringBuilder. toStrihg方法</p>
<p>例如：</p>
<p>在循环体中 使用 string s = s +”123” 是很耗时的，因为每次拼接都new 一个StringBuilder 以及String    调用append方法，十分耗时！</p>
<p>StringBuilder 扩容优化  直接指定长度  个人测试后发现这里并不明显？？</p>
<h3><span id="intern">intern()</span></h3><p>确保字符串在内存中只有一份</p>
<p><span style="color:red;font-size:24px">面试题</span></p>
<ol>
<li><p>new String(“ab”) 会构建几个对象？</p>
<p>两个   </p>
<p>一个对象是new关键字在堆控件创建的</p>
<p>一个对象是字符串常量池中的对象，  ldc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> 0 new #4 &lt;java&#x2F;lang&#x2F;String&gt;</span><br><span class="line"> 3 dup</span><br><span class="line"> 4 ldc #5 &lt;123&gt;</span><br><span class="line"> 6 invokespecial #6 &lt;java&#x2F;lang&#x2F;String.&lt;init&gt;&gt;</span><br><span class="line"> 9 astore_1</span><br><span class="line">10 return</span><br></pre></td></tr></table></figure></li>
<li><p>new Sting(“a”) + new String(“b”)呢？</p>
<p>new String 创建在堆控件中</p>
<p>String a = “a”如果已经有a ，则是常量池中的对象</p>
<p><strong>6个</strong>  注意 + 的拼接操作是Stringbuilder  StringBuilder的toString 会再new 一个String </p>
<p><span style="color:orange;font-size:24px">toString方法在字符串常量池中没有该String！</span>验证后确实没有</p>
</li>
<li><p>在jdk 6 和 jdk7/8的区别</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308162129529.png" alt="image-20210308162129529"></p>
<p> <img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308165709630.png" alt="image-20210308165709630"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308161926144.png" alt="image-20210308161926144"></p>
<p>如果变换string s4=”11”和s3.intern的位置后结果如何？</p>
</li>
</ol>
<p>​    jdk6 中 s3.intern 创建了新的对象“11”，也就是有新的地址   常量池在永久代中‘</p>
<p>如果常量池中没有，则复制一份，放入常量池中</p>
<p>​    jdk7 中 由于常量池放入堆空间中，他就直接拿堆空间的地址。 常量池记录的是堆空间“11”地址  只占四个字节</p>
<p>​    JDK 1.7后，intern方法还是会先去查询常量池中是否有已经存在，如果存在，则返回常量池中的引用，这一点与之前没有区别，区别在于，如果在常量池找不到对应的字符串，<strong>则不会再将字符串拷贝到常量池</strong>，而<strong>只是在常量池中生成一个对原字符串的引用</strong>。简单的说，就是往常量池放的东西变了：原来在常量池中找不到时，复制一个副本放到常量池，1.7后则是将在堆上的地址引用复制到常量池。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String s1 = <span class="keyword">new</span> String(<span class="string">&quot;1&quot;</span>)+<span class="keyword">new</span> String(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">s1.intern();</span><br><span class="line">String s2 =<span class="string">&quot;12&quot;</span>;</span><br><span class="line">System.out.println(s1==s2);</span><br></pre></td></tr></table></figure>

<p><span style="color: #DA70D6;font-size:24px">疑问：为什么intern后再string s = “123”相同的字符串，这时java堆既有123在堆中引用，又有在常量池的对象，为什么比较还是一样的？</span></p>
<p>解答：创建s会直接去常量池中创建，但发现有这个对象了，创建的是指向原来堆中对象的一个引用     没看native层源码，不是非常清楚</p>
<p><span style="color:#FA8072;font-size:24px">易错例题</span></p>
<blockquote>
<p>Q：下列程序的输出结果：<br>String s1 = “abc”;<br>String s2 = “a”;<br>String s3 = “bc”;<br>String s4 = s2 + s3;<br>System.out.println(s1 == s4);<br>A：false，因为s2+s3实际上是使用StringBuilder.append来完成，会生成不同的对象。</p>
</blockquote>
<blockquote>
<p>Q：下列程序的输出结果：<br>String s1 = “abc”;<br>final String s2 = “a”;<br>final String s3 = “bc”;<br>String s4 = s2 + s3;<br>System.out.println(s1 == s4);<br>A：true，因为final变量在编译后会直接替换成对应的值，所以实际上等于s4=”a”+”bc”，而这种情况下，编译器会直接合并为s4=”abc”，所以最终s1==s4。</p>
</blockquote>
<p>​    <strong>实际操作中 添加多个相同的new String对象， intern成倍的影响速度</strong></p>
<h2><span id="垃圾回收">垃圾回收</span></h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309154809269.png" alt="image-20210309154809269"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309155016450.png" alt="image-20210309155016450"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309155037374.png" alt="image-20210309155037374"></p>
<ul>
<li>垃圾： 运行程序中没有任何指针指向的对象</li>
</ul>
<p>GC的主要作用域 ： 方法区 和 堆</p>
<h3><span id="垃圾标记算法">垃圾标记算法</span></h3><h4><span id="对象存活判断">对象存活判断</span></h4><h5><span id="1-引用计数法">1. 引用计数法</span></h5><p>​    每个对象保留整型的引用计数器属性  记录对象被引用的情况 </p>
<p>​    引用时 +1 引用失效 -1</p>
<p>​    引用为 0 进行回收</p>
<p>​    优点： 简单，便于标识，判断效率高，回收无延迟</p>
<p>​    缺点： 单独的空间存储开销；每次加减 ，时间开销；<strong>无法处理循环引用的情况***</strong>（致命）**{相互引用，永不为0， 1–&gt;</p>
<p>​                2—&gt;3—&gt;2   放弃1时， 还存在 2–&gt;3–&gt;2的循环引用}  内存泄露</p>
<p>​    <img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309161215885.png" alt="image-20210309161215885"></p>
<h5><span id="2-可达性分析算法">2. 可达性分析算法</span></h5><p>​    JVM 选用</p>
<p>​    有效解决了循环引用问题，防止内存泄漏发生、简单高效</p>
<ul>
<li><p>GC Roots ：一组必须活跃的引用</p>
<ol>
<li><p>按照<strong>GC Roots</strong> 为起始点，从上至下 搜索被根对象集合所连接的目标对象是否可达】</p>
</li>
<li><p>使用可达性分析算法后，内存中存活的对象都会被根对象集合 直接或间接连接，搜索所走过的路径称为<strong>引用链</strong></p>
</li>
<li><p>如果目标对象没有和任何引用链相连，则不可达，标记为垃圾对象</p>
</li>
</ol>
</li>
<li><p>GC Roots 可以是什么：</p>
<ul>
<li>JVM栈中对象  方法中的参数、局部变量……</li>
<li>JNI引用的对象</li>
<li>类静态属性引用的对象</li>
<li>常量引用的对象 （StringTable 中）</li>
<li>被synch持有的对象</li>
<li>JVM内部的引用 Class对象，系统内加载器</li>
<li>一个指针，保存了root堆内存的对象，但他自己又没有在堆里边，他就是一个root</li>
</ul>
</li>
</ul>
<h4><span id="对象的finaliztion机制">对象的finaliztion机制</span></h4><p>对象销毁之前可以自定义处理逻辑</p>
<p>对象回收之前会执行 finalize()方法 ，可以在子类重写该方法</p>
<p><span style="color:red;font-size:24px">永远不要主动的调用对象的finalize方法</span></p>
<ul>
<li>finalize可能导致对象复活</li>
<li>执行时间没有保障，由GC线程决定</li>
<li>可能影响GC性能</li>
</ul>
<p>虚拟机中对象的三种状态：</p>
<ol>
<li>可触及的</li>
<li>可复活的  所有引用被释放，但可能在finalize中复活</li>
<li>不可触及的  调用finalize 且没有复活</li>
</ol>
<p>判断一个对象是否可回收   至少两次标记</p>
<p><span style="color: #00BFFF;font-size:20px">理解finalize方法 — 一生只能使用一次的免死金牌</span></p>
<ol>
<li>到GC Roots没有引用连</li>
<li>筛选，判断是否有必要执行finalize<ol>
<li>没有重写 finalize方法 —-没必要    finalize方法被调用 —-没必要执行</li>
<li>重写了且未被执行   被插入F-Queue队列中   由优先级较低的Finalizer线程执行</li>
<li>finalize调用是对象唯一能复活的机会，稍后GC会对F-Queue的对象进行二次标记，如果在finalize中该对象和引用链任何一个对象建立了联系，则第二次标记，该对象会被移除“即将回收”集合， 如果伺候，对象再次出现没有引用存在的情况，这个时候由于一个对象的finalize方法只会执行一次，对象直接变成不可触及状态</li>
</ol>
</li>
</ol>
<p>finalize用法的最好实践</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Obj obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        obj = <span class="keyword">new</span> Obj();</span><br><span class="line">        <span class="keyword">if</span>(obj != <span class="keyword">null</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;obj is alive&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        obj = <span class="keyword">null</span>;</span><br><span class="line">        System.gc();	<span class="comment">//一定要调用gc </span></span><br><span class="line">        Thread.sleep(<span class="number">2000</span>);<span class="comment">//注意点</span></span><br><span class="line">        System.out.println(obj == <span class="keyword">null</span>?<span class="string">&quot;null&quot;</span>:<span class="string">&quot;alive&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.finalize();</span><br><span class="line">        System.out.println(<span class="string">&quot;xdm我要被回收了 救我&quot;</span>);</span><br><span class="line">        obj = <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">        obj is alive</span></span><br><span class="line"><span class="comment">        xdm我要被回收了 救我</span></span><br><span class="line"><span class="comment">        -----2s</span></span><br><span class="line"><span class="comment">        alive</span></span><br><span class="line"><span class="comment">	*/</span></span><br></pre></td></tr></table></figure>

<p>​    注意点，这里为什么要休眠2s？ </p>
<p>​    Finalizer是低优先级的线程， 并发时 可能会有耗时 ，直接不休眠的话，会显示为null</p>
<p>​    </p>
<p>使用mat 和 JVisualVM 查看dump堆</p>
<p>JProfiler 进行GC溯源</p>
<h3><span id="垃圾清除算法">垃圾清除算法</span></h3><p>成功判断死活对象后，就是执行垃圾回收操作了，释放无用对象所占的空间</p>
<p>JVM常见的三种垃圾收集算法</p>
<ul>
<li>标记-清除算法</li>
<li>复制算法</li>
<li>标记-压缩算法</li>
</ul>
<h4><span id="标记-清除-算法">标记 - 清除 算法</span></h4><p>Mark - Sweep</p>
<p>堆中有效内存耗尽  — 停止整个程序 STW —标记 / 清除</p>
<ul>
<li>标记：Collector 从引用根节点开始遍历，标记所有<strong>被引用的对象</strong>  ，在对象头中记录为可达对象</li>
<li>清除：Collector对堆内存从头到尾遍历（所有），如果发现对象的对象头中没有标记为可达，则回收</li>
</ul>
<p>缺点：</p>
<ol>
<li>效率不高  两次遍历</li>
<li>GC时会STW</li>
<li>清理出的内存空间是不连续的，需要维护一个列表</li>
</ol>
<p>清除？</p>
<p><strong>清除不是置空，是把要清除的对象地址，保存在空间的地址列表中，下次有新对象要加载时，判断垃圾的位置空间是不是够，如果够就覆盖</strong></p>
<h4><span id="复制算法">复制算法</span></h4><p>解决 标记清除算法在垃圾收集效率的缺陷</p>
<p>将活着的内存分为两块，每次只使用一块，垃圾回收时，将使用的内存的存活对象复制（复制后的就是连续的空间了）到未被使用的内存块中，之后清除正在使用的内存块中的所有对象，交换角色  (类比Survivor区)</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309181613653.png" alt="image-20210309181613653"></p>
<p>优点：</p>
<ul>
<li>没有清除标记的过程，实现简单</li>
<li>复制后的空间是连续的，不需要空闲列表  ，使用指针碰撞</li>
</ul>
<p>缺点：</p>
<ul>
<li>始终可用的内存空间为1/2</li>
<li>G1 分拆成大量region的GC，复制需要维护region之间对象的引用关系，也有时间开销 （Java对象的访问方式）</li>
<li>系统中垃圾很多 —导致复制算法很慢   适用于Survivor区 （回收性价比高）</li>
</ul>
<h4><span id="标记-压缩算法">标记 - 压缩算法</span></h4><p>Mark - Compat</p>
<p>标记： 与 标记清除算法相同</p>
<p>压缩：所有存活的对象压缩到内存的一段，<strong>按照顺序排放</strong>，之后清理边界外的所有空间 </p>
<p> 差异： 移动式的 </p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309183437564.png" alt="image-20210309183437564"></p>
<p>压缩 后内存规整  可以用指针碰撞</p>
<p>优点：</p>
<ul>
<li><p>消除了标记清除算法中内存区域分散的缺点、</p>
</li>
<li><p>消除了赋值算法中内存减半的高额代价</p>
</li>
</ul>
<p>缺点：</p>
<ul>
<li>效率 低于复制算法</li>
<li>移动对象时，如果对象被其他对象引用，还需要调整引用的地址</li>
<li>移动过程中 ，触发STW</li>
</ul>
<h4><span id="对比">对比</span></h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309184113952.png" alt="image-20210309184113952"></p>
<h4><span id="分代收集算法">分代收集算法</span></h4><p>不同生命周期的对象采用不同的收集方式，提高回收效率 </p>
<p>几乎所有的GC都采用</p>
<ol>
<li><p>Young Gen 回收频繁、生命周期短    Coping</p>
</li>
<li><p>Old Gen 生命周期长、存活率高    Sweep 和 Compat 整合</p>
<p>Mark 阶段开销与<strong>存活对象</strong>正比</p>
<p>Sweep 与管理区域的大小成正相关（堆的遍历）</p>
<p>Compat 与存活对象的数据正比</p>
</li>
</ol>
<h4><span id="增量收集算法">增量收集算法</span></h4><p>基本思想：GC线程和主线程  交替进行并发清理垃圾，让用户感受不到STW</p>
<p>基础： Sweep 和 Compat</p>
<p>缺点：</p>
<p>线程切换和上下文转换有消耗，使得垃圾回收总成本上升，系统吞吐量下降</p>
<p>（同时做两件事，结果都做的不是很好）</p>
<h4><span id="分区算法">分区算法</span></h4><p>堆空间越大 GC时间越长</p>
<p>分割内存区域为多个小块 region ，减少目标停顿时间，每次合理地回收若干个小空间 而不是整个堆空间</p>
<h3><span id="概念">概念</span></h3><h4><span id="systemgy">System,gy()</span></h4><p>Runtijme.getRunTime().gc() 显示触发 Full GC </p>
<p>但是附带<strong>免责声明</strong>，无法保证对垃圾收集器的调用</p>
<p>调用System.runFinalization  强制调用使用引用对象的finalize方法</p>
<ul>
<li>主动gc的几种情况</li>
</ul>
<h4><span id="内存溢出">内存溢出</span></h4><p>定义： 没有空闲内存且垃圾收集器也无法提供更多内存（OOM前会进行一次Full GC）</p>
<h4><span id="内存泄露">内存泄露</span></h4><p>没有引用 ， 但GC不能进行回收</p>
<p>例如： 单例模式、未调用close方法</p>
<h4><span id="stw">STW</span></h4><p>可达性分析算法中枚举根节点 GC Roots导致所有的Java线程停顿</p>
<ul>
<li>确保分析工作在一个一致性的<strong>快照</strong>中进行，例如JVisualVm生成 堆dump 不同时间是不同的</li>
<li>一致性指整个分析期间 整个执行系统 像被冻结在某个时间点上</li>
<li>如果分析过程中对象的引用关系还在不断变化，则分析结果的准确性也无法保证</li>
</ul>
<p>JVM后台自动发起STW 开发中不要用STW</p>
<p>理解代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h4><span id="垃圾回收的并行和并发">垃圾回收的并行和并发</span></h4><p>并发</p>
<p>几个程序处于启动状态且都在同一个处理器上完成，时间片</p>
<p>（在同一时间段发生）</p>
<p>垃圾回收的并行：  多条垃圾收集线程并行工作，仍在 STW</p>
<p><span style="color:red;font-size:24px">多核中并发是怎样的</span></p>
<p>并行</p>
<p>系统多个CPU或者多核时，一个CPU一个核执行一个进程与另一个CPU或者另一个核同时执行一个线程，就是并行 </p>
<p>（在同一时间点发生）</p>
<p>垃圾回收的并发 ：用户线程和垃圾收集线程同时进行（交替），不会引起STW</p>
<p>垃圾收集程序在一个核  用户程序在另一个核</p>
<h4><span id="安全点和安全区域">安全点和安全区域</span></h4><h5><span id="安全点">安全点</span></h5><p>并不是所有的地方都可以立马停下来 GC   必须在特定的地方停下来 即 Safe Point</p>
<p>安全点太少 —-  GC等待时间过长</p>
<p> 太多 —- 性能问题</p>
<ul>
<li><p>抢先式中断（未采用）</p>
<p>暂停所有线程，如果有线程不在安全点上，就回复线程，让线程跑到安全点上</p>
</li>
<li><p>主动式中断</p>
<p>设置中断标志，各个线程跑到Safe point去看这个 标志，如果是真的，则挂起</p>
</li>
</ul>
<h5><span id="安全区">安全区</span></h5><p>程序block时无法响应 JVM中断   — Safe region 解决</p>
<p>一段代码片段， 对象的引用关系不变， 任何位置开始GC都是安全的（二维的safe point）</p>
<p>实际执行</p>
<ol>
<li>线程跑到safe region时，标识进入了safe region 如果发生GC， 则JVM忽略标识为Safe Region的线程</li>
<li>准备离开Safe region时，会检查JVM是否完成 GC，如果完成了则继续运行，如果没完成GC，则线程必须等待，知道收到了GC完成的命令 才会离开Safe region</li>
</ol>
<h3><span id="引用">引用</span></h3><p>希望有这么一群对象，内存空间够，就在这，不够，就把他抛弃</p>
<p><span style="color:red;font-size:24px">强引用、软引用、弱引用、虚引用有什么区别，具体使用场景是什么？</span></p>
<h4><span id="强引用">强引用</span></h4><p>new Object  无论任何情况，只要强引用关系还在，垃圾收集器就永远不会回收掉被引用的对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">Student s2 = s1;</span><br><span class="line">s1 = <span class="keyword">null</span>;</span><br><span class="line">System.gc();</span><br><span class="line"><span class="comment">//sleep</span></span><br><span class="line">syso s2.name;</span><br></pre></td></tr></table></figure>

<p>上述结果能输出s2的名字，因为由于是强引用，s1虽然没有引用了，但s2仍然持有堆空间中对象的引用，所以full gc时没有被清理</p>
<h4><span id="软引用soft">软引用Soft</span></h4><p>OOM前 或者 内存<strong>快要满了</strong>，将会把这些对象放入回收范围中进行二次回收，如果回收内存不够，才会报OOM</p>
<p>注意软引用的使用方式  –  使用后要把强引用给置空，使得强引用无效</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">   Teacher1 teacher = <span class="keyword">new</span> Teacher1();</span><br><span class="line">   SoftReference&lt;Teacher1&gt; softReference = <span class="keyword">new</span> SoftReference&lt;Teacher1&gt;(teacher);</span><br><span class="line">   teacher = <span class="keyword">null</span>;</span><br><span class="line">   softReference.get().setName(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">   <span class="comment">//System.out.println(teacher.getName()); Null pointer</span></span><br><span class="line"><span class="comment">//-Xms10m -Xmx10m</span></span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span> * <span class="number">10</span>];</span><br><span class="line">   &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">   &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">       System.out.println(softReference.get().getName());</span><br><span class="line">       <span class="comment">// nullpointer</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h4><span id="弱引用weak">弱引用Weak</span></h4><p>只能生存到下一次垃圾收集之前</p>
<h5><span id="weakhashmap">WeakHashMap</span></h5><p>存储图片信息，内存不足，自动清理   内部Entry继承了WeakReference</p>
<h4><span id="虚引用phantomreference">虚引用PhantomReference</span></h4><p>唯一目的，对象被收集器回收前收到系统的通知，记录回收时间</p>
<p>需要指定引用队列</p>
<p>get拿不到对象</p>
<h2><span id="垃圾回收期">垃圾回收期</span></h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322141038714.png" alt="image-20210322141038714"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322141151403.png" alt="image-20210322141151403"></p>
<p>-XX PrintCommandlineflags 查看默认垃圾收集器</p>
<h3><span id="指标">指标</span></h3><p><strong>吞吐量</strong>： 运行用户代码时间占总运行时间的比例</p>
<p>垃圾收集开销： 吞吐量的补数，垃圾收集所用时间与总运行时间比例</p>
<p><strong>暂停时间</strong>：一个时间段内应用程序线程暂停让GC线程执行</p>
<p>内存占用：Java堆区所占的内寸大小</p>
<p> 吞吐量优先 与 注重暂停时间：</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322150414860.png" alt="image-20210322150414860"></p>
<ul>
<li>高吞吐量：用户感觉只应用线程在做工作，运行快</li>
<li>低暂停时间：交互更好</li>
<li>两者相互矛盾</li>
</ul>
<p><strong>现在的标准： 在最大吞吐量优先情况下，降低暂停时间</strong></p>
<h3><span id="serial">Serial</span></h3><p>串行收集器： 单线程 只使用一个CPU或一条收集线程完成垃圾收集工作  还会触发 STW</p>
<p> 年代久远Client 模式下默认  、 复制算法 、STW、串行回收</p>
<p><strong>Old</strong></p>
<p>标记-压缩</p>
<p>Client模式默认</p>
<p>Server模式 与新生代ParallelScavenge配合  、 CMS后备垃圾收集方案</p>
<p>串行收集器采用单线程stop-the-world的方式进行收集。当内存不足时，串行GC设置停顿标识，待所有线程都进入安全点(Safepoint)时，应用线程暂停，串行GC开始工作，采用单线程方式回收空间并整理内存。单线程也意味着复杂度更低、占用内存更少，但同时也意味着不能有效利用多核优势。事实上，串行收集器特别适合堆内存不高、单核甚至双核CPU的场合。</p>
<p><strong>优点</strong></p>
<p>简单高效   没有线程交互的开销 </p>
<p>适用单核 、 嵌入式</p>
<p>-XX ：+UserSerialGC</p>
<h3><span id="parnew">ParNew</span></h3><p>Parllel New 对新生代并行回收</p>
<p>新生代回收次数频繁，用并行高效</p>
<p>复制算法 – STW</p>
<p><strong>是否ParNew的并行收集就一定比Serial串行快？</strong></p>
<p>​    单CPU环境下，ParNew就没有Serial收集器高，因为这时CPU不需要频繁地做任务切换，因此可以有效避免线程交互过程中不必要开销</p>
<p>-XXL ParallelGCThreadss num     限制线程数量 default 和CPU数据相同的线程</p>
<h3><span id="parallel">Parallel</span></h3><p>复制、并行、STW</p>
<p>年轻代采用复制算法，老年代采用标记-整理，在回收的同时还会对内存进行压缩</p>
<p>与ParNew不同点：</p>
<ul>
<li><p>吞吐量优先，目的为到达可控制的吞吐量</p>
</li>
<li><p>自适应调节策略</p>
</li>
</ul>
<p>高吞吐量 高效利用CPU时间 适合在后台运算不需要太多交互、服务器中</p>
<p>JDK1.6 用Parallel Old 替代了 老年代的Serial Old</p>
<p>-XX +UseParallel(Old)GC  互相激活</p>
<p>-XX：ParallelGCThreads num 设置年轻代并行收集器线程数</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322145201261.png" alt="image-20210322145201261"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322145313728.png" alt="image-20210322145313728"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322145728931.png" alt="image-20210322145728931"></p>
<h3><span id="cms">CMS</span></h3><p>Concurrent Mark Sweep  针对老年代 —ParNew</p>
<p>低延迟，第一次实现了让垃圾收集线程和用户线程同时工作</p>
<p>尽可能缩短垃圾收集时用户线程的停顿时间</p>
<p>G1 整体上采用标记-整理算法，局部是通过复制算法，不会产生内存碎片。</p>
<p>垃圾收集算法采用标记-清除算法</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210324080947878.png" alt="image-20210324080947878"></p>
<ul>
<li>初始标记 ：STW 标记GC Roots <strong>直接</strong>关联到的对象</li>
<li>并发标记：从直接关联对象开始遍历整个对象图的过程，释放内存空间，与用户线程同时运行</li>
<li>重新标记：STW 修整并发标记期间，标记产生变动的对象。时间稍短</li>
<li>并发清除：清理删掉标记阶段判断的已经死亡的对象，释放内存空间、</li>
</ul>
<p>并发时期，要确保程序用户线程有足够的内存可以用。因此CMS收集器不能像其他收集器那样等到老虎年代几乎被填满再回收。当堆内存使用率达到一定阈值，便开始回收，确保应用程序在CMS工作过程中，依然有足够的控件支持应用程序运行。如果CMS运行期间预留的内存无法满足程序需要，就会出现一次Concurrent Mode Failure失败，JVM启动后备方案，用Serial Old收集器重新进行老年代的垃圾收集，停顿时间长</p>
<p>缺点： </p>
<ul>
<li>标记清除算法，产生碎片，只能选择空闲列表执行内存分配，不能放入大对象</li>
<li>对CPU资源敏感，并发时占用一部分线程，总吞吐量降低</li>
<li>无法处理<strong>浮动垃圾</strong>：用户线程产生新的垃圾，并发标记时产生的垃圾无法被标记（注意 重新标记是修成并发标记已标记的对象，即已经是垃圾的可能又不是垃圾了[保险操作]）</li>
</ul>
<p><strong>为什么不换成Mark Compact？</strong></p>
<p>压缩时会对内存进行整理，但是清理的时候是并发执行的，不能改变使用对象的地址</p>
<p>JDK9 废弃   JDK14 已经把CMS移除了</p>
<p>-XX：+UseConcMarkSweepGC 手动指定使用CMS</p>
<p>-XX: CMSlinitialtingOccupanyFraction  设置堆内存使用率阈值  默认 92   </p>
<h3><span id="g1">G1</span></h3><p>区域化分代式</p>
<p>JDK 9 开始采用，面向服务端应用</p>
<p>适应不断扩大的内存和不断增加的处理器数量  降低暂停时间且兼顾良好的吞吐量</p>
<p><strong>为什么 叫G1?</strong></p>
<p>​    并行收集器，划分堆内存  ，使用不同Region表示Eden Survivorws Old Gen等</p>
<p>垃圾优先：</p>
<p>​    G1 GC 有计 划避免了这个堆中进行全区域的垃圾回收，跟踪不同的Region垃圾堆积的价值大小，回收所获得的空间大小与回收所需时间的经验值。  维护一个优先列表，根据允许的收集时间，优先回收价值最大的Region</p>
<p><strong>特点：</strong></p>
<ol>
<li><p>并行并发兼具：</p>
<p>有多个GC线程工作，利用多核  STW</p>
<p>能够与应用程序交替执行，不会STW</p>
</li>
<li><p>分代收集：</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210324084815558.png" alt="image-20210324084815558"></p>
<p>堆空间分成若干Region，可以不连续而且每个小区域的角色是可以变换的？？？？</p>
<p>G1同时兼顾老年代和年轻代。</p>
</li>
<li><p>空间整合：</p>
<p>内存回收以region为基本单位，region之间是复制算法，但整体可以看成是Mark Compact算法（因为分region）。有利于程序长时间运行</p>
</li>
<li><p>可预测的停顿时间模型(软实时 Soft Real-Time)</p>
<p>让使用者明确指定在长度为M ms时间段内，消耗在垃圾收集上的时间不得超过N ms  – 尽可能</p>
<p>根据允许的收集时间，优先回收价值高的region    收集效率高  </p>
</li>
</ol>
<p>JVM GC线程处理速度慢时，系统会调用应用程序线程帮助加速垃圾回收过程</p>
<p><strong>适用场景：</strong></p>
<p>服务端，大内存，多处理器</p>
<p>50%Java堆活动数据占用、对象分配频率或年代提升频率变化大、GC停顿时间长</p>
<p><strong>分区Region</strong></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210324091225275.png" alt="image-20210324091225275"></p>
<p>划分整个堆为2048个大小相同的独立Region 每个region控制在1 - 32 M 之间，每个region大小相同，在JVM生命周期内不会被改变。新生代和老年代通过region的动态分配实现逻辑上的连续</p>
<p>G1还增加了新的内存区域  Humonogous 存储大对象。因为将一个短期存在的大对象放入老年代，会对垃圾收集器造成影响。如果单个H区装不下一个大对象，会找一个连续的H区存储，如果还找不到就Full GC了  ，可将H区看做老年代但不完全相等</p>
<p>对单个Region  分配规则类似指针碰撞，也可以在region中给单个线程分配TLAB</p>
<p>内存占用、额外执行负载 比CMS高      （记忆集）</p>
<p>小内存应用上 CMS优于 G1  大内存G1更优</p>
<p><strong>参数：</strong></p>
<p>-XX:+UseG1GC</p>
<p>-XX:G1HeapRegionSize region  num   大小，2的 num 次方，范围是1m — 32m</p>
<p>–XX:MaxGCPauseMills 设置期望的最大GC停顿时间   默认 200ms</p>
<p>-XX ParallelGCThread  STW工作线程数，最多 8 </p>
<p>-XX ConcGCThreads 设置并发标记的线程数   n设置为并行垃圾收集线程数的1/4左右</p>
<p>-XX InitiaingHeapOccupancyPercent  触发并发GC周期的Java堆占用阈值，超过此值 触发 GC，默认45</p>
<p>​    <strong>垃圾回收过程</strong></p>
<ol>
<li><p>YoungGC</p>
</li>
<li><p>老年代并发标记过程concurrent Marking</p>
</li>
<li><p>Mixed GC</p>
</li>
<li><p>如果需要，Full GC还是存在的，提供一种失败保护机制，强力回收  — 单线程、独占式、高强度</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326155145913.png" alt="image-20210326155145913"></p>
</li>
</ol>
<h4><span id="remeberedset-记忆集">RemeberedSet 记忆集</span></h4><ul>
<li>一个对象可能被不同区域的对象引用  Old区 引用了 Eden区 。判断对象是否存活，是否要扫喵整个堆？  </li>
<li>回收新生代，不得不扫描老年代 ， 降低Minor GC效率</li>
</ul>
<p>解决</p>
<ul>
<li>使用RemberedSet进行全局扫描</li>
<li><strong>每个Region都有一个Remebered Set</strong></li>
<li>每次引用类型数据进行写操作时，都会有一个Write Barrier  （写屏障） 中断 ， 检查要写入的引用指向的对象是否和该引用类型数据在不同的region</li>
<li>如果不同，通过CardTable把相关引用信息记录到引用指向对象所在region对应的RS 中(本体)</li>
<li>进行垃圾收集时，在GC根节点的枚举范围加入RS，保证不进行全局扫描也不会有遗漏</li>
</ul>
<h4><span id="回收具体过程">回收具体过程</span></h4><p><strong>YoungGC</strong></p>
<p>Eden空间，G1触发YoungGC  只回收Eden Survivor区 </p>
<p>YoungGC 首先G1停止STW ，G1创建回收集 CS ，即需要背回收的内存分段集合，YoungGC 的 CS包含Eden区和Survivor、区的所有内存分段</p>
<p> <img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326161642195.png" alt="image-20210326161642195"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326162531425.png" alt="image-20210326162531425"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326162602055.png" alt="image-20210326162602055"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326164133102.png" alt="image-20210326164133102"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326164237342.png" alt="image-20210326164237342"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/coderlius/article/details/79272773">https://blog.csdn.net/coderlius/article/details/79272773</a></p>
<h1><span id="深入篇">深入篇</span></h1><h2><span id="字节码">字节码</span></h2><h3><span id="编译">编译</span></h3><p>javac编译器</p>
<p>将java源码编译成字节码的前端编译器   IDEA 默认</p>
<p>类似的  ECJ (Eclipse Compiler for Java) 编译效率高，编译时并非全量编译，只编译为编译部分的源码进行编译</p>
<p>Eclipse 和 Tomcat默认使用</p>
<h4><span id></span></h4><p><span style="color:red;font-size:24px">Integer的自动装箱</span></p>
<p>内置的IntegerCache</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Integer a = <span class="number">127</span>;</span><br><span class="line">Integer b = <span class="number">127</span>;</span><br><span class="line">System.out.println(a == b);</span><br><span class="line"><span class="comment">//false </span></span><br><span class="line"><span class="comment">//字节码 比较时涉及到intValue方法</span></span><br><span class="line"><span class="comment">//new时涉及valueOf方法 </span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">intValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">valueOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class="line">        <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Integer(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerCache</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> low = -<span class="number">128</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> high;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> Integer cache[];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// high value may be configured by property</span></span><br><span class="line">        <span class="keyword">int</span> h = <span class="number">127</span>;</span><br><span class="line">        String integerCacheHighPropValue =</span><br><span class="line">            sun.misc.VM.getSavedProperty(<span class="string">&quot;java.lang.Integer.IntegerCache.high&quot;</span>);</span><br><span class="line">        <span class="comment">//可以自行设置max的最大值</span></span><br><span class="line">        <span class="keyword">if</span> (integerCacheHighPropValue != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class="line">                i = Math.max(i, <span class="number">127</span>);</span><br><span class="line">                <span class="comment">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class="line">                h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span>( NumberFormatException nfe) &#123;</span><br><span class="line">                <span class="comment">// If the property cannot be parsed into an int, ignore it.</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        high = h;</span><br><span class="line"></span><br><span class="line">        cache = <span class="keyword">new</span> Integer[(high - low) + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> j = low;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; cache.length; k++)</span><br><span class="line">            cache[k] = <span class="keyword">new</span> Integer(j++);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class="line">        <span class="keyword">assert</span> IntegerCache.high &gt;= <span class="number">127</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">IntegerCache</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>涉及到的静态内部类的知识</p>
<p>静态内部类只会在使用到该内部类时才会加载，否则是不会加载的，也就是只有使用到new Integer的valueOf方法时，才会加载该内部类</p>
<h3><span id="概念">概念</span></h3><p>字节码指令是一个一个字节长度，代表某种特定含义的操作码，以及跟随其后的参数—操作数构成的。</p>
<h4><span id="class文件">Class文件</span></h4><p>不一定以磁盘文件形式存在，是一组以8字节为基础单位的二进制流</p>
<p>存储格式   无符号数 + 表</p>
<p>无法包含注释信息</p>
<ul>
<li><p>无符号数： 基本数据类型   用u1、u2、u4.、u8.. 表示多少个字节的无符号数</p>
</li>
<li><p>表： 由多个无符号数或者其他表作为数据项构成的复合数据类型  </p>
<p>表又_info 结尾    整个class文件就是一张表</p>
</li>
</ul>
<h3><span id="class文件结构">Class文件结构</span></h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210313171015628.png" alt="image-20210313171015628"></p>
<h4><span id="魔数">魔数</span></h4><p>cafebabe  识别字节码文件  4个字节的无符号整数</p>
<h4><span id="class文件版本">Class文件版本</span></h4><p>主版本、副版本  — 依据JDK</p>
<p>向下兼容： 高版本JVM可运行低版本JDK编译器生成的class文件</p>
<p>UnsupportedClassVersionError</p>
<h4><span id="常量池">常量池</span></h4><p>字面量从1开始而不是从0 开始  但是计数器从0开始计数</p>
<p>存放字面量和符号引用 — 类加载时放在方法区的运行时常量池中</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315163802015.png" alt="image-20210315163802015"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315162456278.png" alt="image-20210315162456278"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315162921696.png" alt="image-20210315162921696"></p>
<p>解析</p>
<p>第一个字节指出是什么类型（Constant-utf8_info之类的），然后在看对应类型 有什么样的字节，具体会不一样</p>
<h4><span id="访问标志">访问标志</span></h4><h4><span id="类索引-父类索引-接口索引集合">类索引、父类索引、接口索引集合</span></h4><h4><span id="字段表集合">字段表集合</span></h4><h4><span id="方法表集合">方法表集合</span></h4><h4><span id="属性表集合">属性表集合</span></h4><h2><span id="查漏补缺篇">查漏补缺篇</span></h2><h3><span id="担保机制">担保机制</span></h3><p>survivor区装不下了怎么办</p>
<h3><span id="晋升原理">晋升原理</span></h3><p>大对象是如何分配的</p>
<h3><span id="string">String</span></h3><p>String 作为参数在方法内部改变为什么不会改变实际的值</p>
<h3><span id="类加载机制">类加载机制</span></h3><h4><span id="类加载">类加载</span></h4><p>将Java类的字节码文件加载到内存中  并在内存中构建出java类的原型，类模板对象</p>
<ul>
<li><p>通过类的全名，获取类的二进制数据流</p>
<p>获取方式：</p>
<ul>
<li>class文件</li>
<li>jar zip文件</li>
<li>数据库中的二进制</li>
<li>http网络协议</li>
<li>运行时动态生成Class的二进制信息</li>
</ul>
</li>
<li><p>解析类的二进制数据流为方法区的数据结构  Java类模型</p>
</li>
<li><p>创建java.lang.Class 类的实例，表示该类型，作为方法区这个类的各种数据的访问入口</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210320150701121.png"></p>
<p>数组类型的加载，数组类本身并不由类加载器负责创建。由JVM运行时根据需要直接创建的，数组的元素类型仍然需要依靠类加载器创建 ，如果数组的元素类型是引用类型，则数组类的可访问性就由元素类型的可访问性决定，缺省定义为public</p>
</li>
</ul>
<h4><span id="链接">链接</span></h4><h5><span id="验证">验证</span></h5><p>保证加载的字节码合法 规范</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210320151441865.png" alt="image-20210320151441865"></p>
<p><strong>格式验证</strong></p>
<p>和加载过程一起进行，验证通过后，类加载器才会成功将该类的二进制数据信息加载到方法区中，格式验证之外的操作在方法区中运行</p>
<p><strong>语义验证</strong></p>
<p>是否素有的类都有父类的存在</p>
<p>是否一些定义为final的方法或者类被重写或者继承了</p>
<p>非抽象类是否实现了所有抽象方法 或者接口方法</p>
<p>是否存在不兼容的方法  方法的签名除了返回值都一样的情况</p>
<p><strong>字节码验证</strong></p>
<p>较为复杂的过程</p>
<p>字节码执行过程中，是否会跳转到一条不存在的指令、</p>
<p>函数调用是否传递了正确类型的参数</p>
<p>变量</p>
<p>赋值是不是给了正确的数据类型</p>
<p>栈映射帧  – StackMapTable用于检测在特定的字节码出，局部变量表和操作数栈是否有正确的数据信息</p>
<p><strong>符号引用</strong></p>
<p>检查 自己要使用其他类 或者方法 是否存在    （在字符串常量池中）</p>
<h5><span id="准备">准备</span></h5><p>为类的静态变量分配内存</p>
<p>注意点：java并不支持boolean  对于boolean 内部实现是int，默认值是0，故boolean的默认值就是false    </p>
<ul>
<li>不包含基本数据类型用static final修饰的情况，因为final在编译时分配，且在准备阶段会显示赋值</li>
<li>非final修饰的变量，解析阶段进行默认初始化赋值，final修饰后，在解析环节直接显示赋值</li>
<li>final类变量不能声明 但不复制</li>
<li>如果以非自变量的形式 初始化static final String ，不会像有具体的代码执行</li>
</ul>
<h5><span id="解析">解析</span></h5><p>将常量池中类、接口、字段、方法的 符号引用转换为直接引用  （真实内存中的地址）</p>
<p>例如 JVM为每个类准备了方法表， 调用一个类的方法时，只要知道这个方法在方法表中的偏移量就可以直接调用该方法。通过解析操作，符号引用就转变为目标方法在<strong>类中方法表的位置</strong></p>
<h4><span id="初始化">初始化</span></h4><p>显示赋值  装载的最后一个阶段</p>
<p>方法的调用 、 构造器的支持  则在clinit中调用</p>
<p>重要工作 ： 执行类的初始化方法 clinit </p>
<ul>
<li><p>该方法只能由Java编译器 生成并由JVM调用</p>
</li>
<li><p>由类静态成员的赋值语句以及static语句块合并产生的</p>
</li>
<li><p>静态的类变量，如果没有显示赋值，则不会调用clinit方法</p>
</li>
<li><p>显示赋值的static final 常量 – 在准备阶段已经显示赋值了，不会调用clinit方法</p>
</li>
<li><p>引用数据类型显示赋值都是在初始化阶段，基本类型 通过库方法赋值 也会在初始化阶段 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> num = <span class="keyword">new</span> Random().nextInt(<span class="number">199</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h4><span id="clinit的线程安全性">clinit的线程安全性</span></h4><p>多线程环境被正确的加锁、同步 。多线程中尝试加载一个类，没抢到锁的会阻塞，若clnit中有耗时很长的操作，可能引发死锁    </p>
<p>clnit中方法 Access flags访问标识  无synchronized  隐式锁</p>
<h4><span id="类的主动使用和被动使用">类的主动使用和被动使用</span></h4><p>区别： 是否会调用clinit方法</p>
<p>注意点： <strong>没有初始化的类 不一定没有加载</strong></p>
<h5><span id="主动使用">主动使用</span></h5><ol>
<li>new 、反射、克隆、反序列化</li>
<li>调用类的静态方法  inovokestatic</li>
<li>使用类、接口的静态字段时 <ul>
<li>如果不是final，则就是主动使用</li>
<li>如果是final 类型， 则如果是字面量形式，则不是主动使用，如果是函数形式 比如 a = new Random().nextInt类型，当尝试调用a时，则是主动使用（因为函数形式的赋值都在clinit中执行）</li>
</ul>
</li>
<li>Class.forName()   </li>
<li>子类构造时会先进行父类的初始化 -XX traceClassLoad 输出所有类加载顺序<ul>
<li>初始化类时，不会先初始化他锁实现的接口，但会加载这个接口Load</li>
<li>初始化接口时，不会初始化他的父接口，但是也会加载Load</li>
</ul>
</li>
<li>接口定义了default方法，直接、间接实现该方法接口的类初始化（只要使用到了这个接口的字段或者方法的） 都会导致这个接口在这之前初始化</li>
<li>初始化main所在类</li>
<li>MethodHandle</li>
</ol>
<h5><span id="被动使用">被动使用</span></h5><ol>
<li>访问静态字段，只有真正声明这个字段的类才会被初始化<ul>
<li>通过子类引用父类的静态变量，不会导致子类初始化，但子类会加载</li>
</ul>
</li>
<li>声明对象数组，不复制，不会引起初始化</li>
<li>引用常量不会的触发类或者接口的初始化  （链接阶段已经赋值）</li>
<li>ClassLoader的loadClass方法加载一个类，不是对类的主动使用，注意与forName区分开</li>
</ol>
<h4><span id="类卸载-unloading">类卸载 Unloading</span></h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322092551016.png" alt="image-20210322092551016"></p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322092757484.png" alt="image-20210322092757484"></p>
<p>一个类结束生命周期，关键在于其Class对象 结束生命周期</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322093200611.png" alt="image-20210322093200611"></p>
<p>不太可能</p>
<h3><span id="动态绑定与静态绑定">动态绑定与静态绑定</span></h3><p>Java对对象属性 是静态绑定 ，方法是动态绑定</p>
<p><strong>根据father在堆中实际创建的对象类型Son来确定f1方法所在的位置</strong></p>
<p>调用虚方法时，Java采用的是<strong>延迟绑定 / 动态分派</strong>的语义，根据被调用对象（receiver）的实际类型来决定选择哪个版本的虚方法。</p>
<p>重载的方法在编译时根据参数的<strong>声明类型</strong>静态绑定到具体方法上，与运行时该参数的实际类型无关</p>
<p>方法的重载是静态编译</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">     Father f = <span class="keyword">new</span> Son();</span><br><span class="line"></span><br><span class="line">     <span class="keyword">new</span> Test1().get(f);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">get</span><span class="params">(Father father)</span></span>&#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;fatherfather&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span> <span class="params">(Son son)</span></span>&#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;sonso3n&quot;</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3><span id="双亲委派机制">双亲委派机制</span></h3><p>JDK  1.2</p>
<p><strong>优点</strong></p>
<ol>
<li>避免类重复加载，确保类的全局唯一性 — GC 有关？</li>
<li>安全，避免构造同包的恶意代码 </li>
</ol>
<p>沙箱安全机制</p>
<p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210404170719177.png" alt="image-20210404170719177"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/08/22/Web%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/22/Web%E5%AD%A6%E4%B9%A0/" itemprop="url">Web学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-22T20:05:07+08:00">
                2019-08-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  3.4k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  13
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="JAVA-WEB-知识"><a href="#JAVA-WEB-知识" class="headerlink" title="JAVA WEB 知识"></a>JAVA WEB 知识</h1><!-- toc -->

<ul>
<li><a href="#%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE">知识回顾</a></li>
<li><a href="#web%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AF%E4%BB%B6">Web服务器软件</a></li>
<li><a href="#tomcat">Tomcat</a><ul>
<li><a href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84">目录结构</a></li>
<li><a href="#%E8%BF%90%E8%A1%8C">运行</a></li>
<li><a href="#%E9%9D%99%E6%80%81%E9%A1%B9%E7%9B%AE%E4%B8%8E%E5%8A%A8%E6%80%81%E9%A1%B9%E7%9B%AE">静态项目与动态项目</a></li>
<li><a href="#%E7%94%A8ieda-%E9%85%8D%E7%BD%AEtomcat">用IEDA 配置TOMCAT</a></li>
</ul>
</li>
<li><a href="#servlet">Servlet</a></li>
</ul>
<!-- tocstop -->

<hr>
<h2 id="知识回顾"><a href="#知识回顾" class="headerlink" title="知识回顾"></a>知识回顾</h2><pre><code>1. IP： 计算机在网络中的唯一标识
2. 端口号： 应用程序在计算机中的唯一标识 0~65536
3. 传输协议： 规定数据传输的规则
 1. 基础协议：
    1. Tcp： 安全协议，三次握手，速度稍慢
    2. Udp：不完全，速度快
</code></pre>
<h2 id="Web服务器软件"><a href="#Web服务器软件" class="headerlink" title="Web服务器软件"></a>Web服务器软件</h2><ul>
<li>服务器：安装了服务器软件的计算机</li>
<li>服务器软件：接受用户请求，处理请求，做出响应</li>
<li>Web服务器软件：结束后用户请求，处理请求，作出响应<ul>
<li>web服务器软件，可以部署web项目，用户通过浏览器来访问项目</li>
<li>web容器</li>
</ul>
</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/08/22/Web%E5%AD%A6%E4%B9%A0/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/07/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/" itemprop="url">数据库 学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-22T20:05:07+08:00">
                2019-07-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  2.7k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  10
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="数据库学习"><a href="#数据库学习" class="headerlink" title="数据库学习"></a>数据库学习</h1><!-- toc -->

<ul>
<li><a href="#mysql">Mysql</a><ul>
<li><a href="#1-ddl">1. DDL :</a></li>
<li><a href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93crud-%E5%8A%9F%E8%83%BD-%E5%88%9B%E5%BB%BA-%E6%9F%A5%E8%AF%A2-%E6%9B%B4%E6%96%B0-%E5%88%A0%E9%99%A4">操作数据库：CRUD 功能    （创建、查询、更新、删除）</a><ul>
<li><a href="#1%E6%9F%A5%E8%AF%A2%E4%B8%8E%E5%88%9B%E5%BB%BA">1.查询与创建</a></li>
<li>[show databases、  create database  xxx  、show create  database xxx(查询名称和字符类型)](#show-databases-create-database-xxx-show-create-database-xxx查询名称和字符类型)</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%93%8D%E4%BD%9C%E8%A1%A8">操作表</a></li>
<li><a href="#dml-%E5%A2%9E%E5%88%A0%E6%94%B9%E8%A1%A8%E4%B8%AD%E6%95%B0%E6%8D%AE">DML 增删改表中数据</a></li>
<li><a href="#dql-%E6%9F%A5%E8%AF%A2%E8%A1%A8%E4%B8%AD%E8%AE%B0%E5%BD%95">DQL 查询表中记录 （*）</a></li>
<li><a href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F">外键约束</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F">数据库设计范式</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A4%87%E4%BB%BD%E5%92%8C%E8%BF%98%E5%8E%9F">数据库的备份和还原</a></li>
<li><a href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2">多表查询</a></li>
<li><a href="#%E4%BA%8B%E5%8A%A1">事务</a></li>
<li><a href="#dcl-%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7%E6%8E%88%E6%9D%83">DCL ：管理用户，授权  ：</a></li>
<li><a href="#jdbc-template-%E4%B8%8E-%E8%BF%9E%E6%8E%A5%E6%B1%A0">JDBC Template 与 连接池</a><ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0">数据库连接池</a></li>
<li><a href="#spring-jdbc-jdbc-template">Spring JDBC–JDBC Template</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h2 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h2><h3 id="1-DDL"><a href="#1-DDL" class="headerlink" title="1.  DDL :"></a>1.  DDL :</h3><h3 id="操作数据库：CRUD-功能-（创建、查询、更新、删除）"><a href="#操作数据库：CRUD-功能-（创建、查询、更新、删除）" class="headerlink" title="操作数据库：CRUD  功能    （创建、查询、更新、删除）"></a>操作数据库：CRUD  功能    （创建、查询、更新、删除）</h3><h4 id="1-查询与创建"><a href="#1-查询与创建" class="headerlink" title="1.查询与创建"></a>1.查询与创建</h4><h4 id="show-databases、-create-database-xxx-、show-create-database-xxx-查询名称和字符类型"><a href="#show-databases、-create-database-xxx-、show-create-database-xxx-查询名称和字符类型" class="headerlink" title="show databases、  create database  xxx  、show create  database xxx(查询名称和字符类型)\"></a>show databases、  create database  xxx  、show create  database xxx(查询名称和字符类型)\</h4><p>​        create database xxx if not exists XX(不会报错)  </p>
<p>​        create database xx character set xxx(utf-8)</p>
<p>​        可以连用语句   create database xxx if not exists XX character set xxx</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/07/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/03/29/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url">数据结构</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-29T20:05:07+08:00">
                2019-03-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  159
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1><span id="数据结构">数据结构</span></h1><!--toc-->

<h2><span id="二叉搜索树">二叉搜索树</span></h2><h3><span id="添加">添加</span></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addNode</span><span class="params">(Node node)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(node.i&lt;<span class="keyword">this</span>.i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.left == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.left = node;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.left.addNode(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.right == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.right = node;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.right.addNode(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>中序遍历</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">midLook</span><span class="params">(Node root)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    midLook(root.left);</span><br><span class="line">    System.out.println(root.i);</span><br><span class="line">    midLook(root.right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>层序遍历</p>
<p><strong>优先队列方式！</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">floorList</span><span class="params">(Node root)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    LinkedList&lt;Node&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line">    Node node ;</span><br><span class="line">    <span class="keyword">while</span>(!queue.isEmpty())&#123;</span><br><span class="line">        node = queue.poll();</span><br><span class="line">        System.out.println(node.i);</span><br><span class="line">        <span class="keyword">if</span>(node.left != <span class="keyword">null</span>)&#123;</span><br><span class="line">            queue.add(node.left);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(node.right != <span class="keyword">null</span>)&#123;</span><br><span class="line">            queue.add(node.right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/01/22/LeetCode%E5%88%B7%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/pipi.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYL的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/22/LeetCode%E5%88%B7%E9%A2%98/" itemprop="url">LeetCode刷题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-22T20:05:07+08:00">
                2019-01-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  9.4k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  45
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="LeetCode-刷题"><a href="#LeetCode-刷题" class="headerlink" title="LeetCode 刷题"></a>LeetCode 刷题</h1><!-- toc -->

<ul>
<li><a href="#jz-03-%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0">JZ-03. 两数相加</a><ul>
<li><a href="#%E6%80%9D%E8%80%83">思考：</a></li>
<li><a href="#1-%E5%9F%BA%E4%BA%8E%E5%93%88%E5%B8%8C%E8%A1%A8">1. 基于哈希表</a></li>
<li><a href="#2-%E5%8E%9F%E5%9C%B0%E7%BD%AE%E6%8D%A2-nb">2. 原地置换  nb</a></li>
</ul>
</li>
<li><a href="#jz-04-%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%9F%A5%E6%89%BE">JZ-04. 二维数组中的查找</a><ul>
<li><a href="#%E8%A7%82%E5%AF%9F">观察：</a></li>
<li><a href="#1-%E8%87%AA%E5%B7%B1%E6%83%B3%E7%9A%84%E7%9F%A9%E9%98%B5%E5%88%86%E5%89%B2%E6%B3%95">1. 自己想的矩阵分割法</a></li>
<li><a href="#2-%E7%BF%BB%E8%BD%AC%E7%9F%A9%E9%98%B5-%E7%BA%BF%E6%80%A7%E6%90%9C%E7%B4%A2">2. 翻转矩阵 / 线性搜索</a></li>
</ul>
</li>
<li><a href="#jz-10-%E9%9D%92%E8%9B%99%E8%B7%B3%E5%8F%B0%E9%98%B6">JZ-10. 青蛙跳台阶</a><ul>
<li><a href="#%E6%80%9D%E8%80%83">思考</a></li>
<li><a href="#1-%E9%80%92%E5%BD%92%E8%B6%85%E6%97%B6">1. 递归（超时）</a></li>
<li><a href="#2-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92">2. 动态规划</a></li>
</ul>
</li>
<li><a href="#jz-14-i-%E5%89%AA%E7%BB%B3%E5%AD%90">JZ-14 -I 剪绳子</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-1">思考：</a></li>
<li><a href="#o-1">O (1):</a></li>
</ul>
</li>
<li><a href="#jz-22-%E9%93%BE%E8%A1%A8%E4%B8%AD%E5%80%92%E6%95%B0%E7%AC%ACk%E4%B8%AA%E8%8A%82%E7%82%B9">JZ-22. 链表中倒数第k个节点</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-1">思考</a></li>
<li><a href="#1-%E9%80%92%E5%BD%92%E5%AF%BB%E6%89%BE">1. 递归寻找？</a></li>
<li><a href="#2-%E5%8F%8C%E6%8C%87%E9%92%88-%E7%9C%9F%E5%A6%99%E5%95%8A">2. 双指针 真妙啊</a></li>
<li><a href="#%E6%80%9D%E8%80%83-2">思考：</a></li>
</ul>
</li>
<li><a href="#jz-24-%E5%8F%8D%E8%BD%AC%E9%93%BE%E8%A1%A8">JZ-24. 反转链表</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-2">思考</a></li>
<li><a href="#1-%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84-pre-%E6%8C%87%E9%92%88%E4%BB%A3%E7%A0%81">1. 自己写的 pre 指针代码</a></li>
<li><a href="#2-%E5%8F%8C%E6%8C%87%E9%92%88">2. 双指针</a></li>
<li><a href="#3-%E9%80%92%E5%BD%92">3. 递归</a></li>
</ul>
</li>
<li><a href="#jz-47-%E7%A4%BC%E7%89%A9%E7%9A%84%E6%9C%80%E5%A4%A7%E4%BB%B7%E5%80%BC">Jz-47. 礼物的最大价值</a><ul>
<li><a href="#1-%E9%80%92%E5%BD%92">1. 递归</a></li>
<li><a href="#2-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92">2. 动态规划</a></li>
</ul>
</li>
<li><a href="#jz-48-%E6%9C%80%E9%95%BF%E7%9A%84%E4%B8%8D%E5%90%AB%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2">Jz-48. 最长的不含重复字符的子字符串</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-3">思考</a></li>
<li><a href="#1-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92">1. 动态规划</a></li>
</ul>
</li>
<li><a href="#jz-54-%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%AC%ACk%E5%A4%A7%E8%8A%82%E7%82%B9">JZ-54. 二叉搜索树第k大节点</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-4">思考</a></li>
<li><a href="#%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86">中序遍历</a></li>
</ul>
</li>
<li><a href="#jz-56-%E6%95%B0%E7%BB%84%E4%B8%AD%E6%95%B0%E7%BB%84%E5%87%BA%E7%8E%B0%E7%9A%84%E6%AC%A1%E6%95%B0-i">JZ-56 数组中数组出现的次数 I</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-5">思考</a></li>
<li><a href="#1-my-hashtable">1. My hashTable</a></li>
<li><a href="#2-my-hashmap">2. My HashMap</a></li>
<li><a href="#3-%E5%BC%82%E6%88%96%E5%A4%A7%E6%B3%95">3. 异或大法</a></li>
</ul>
</li>
<li><a href="#jz-63-%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E5%A4%A7%E5%88%A9%E6%B6%A6">Jz-63. 股票的最大利润</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-6">思考</a></li>
<li><a href="#1-%E5%8F%8C%E6%8C%87%E9%92%88%E9%81%8D%E5%8E%86">1. 双指针遍历</a></li>
<li><a href="#2-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-1">2. 动态规划</a></li>
</ul>
</li>
<li><a href="#1-%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C">1. 两数之和</a><ul>
<li><a href="#%E6%80%9D%E8%B7%AF">思路</a></li>
<li><a href="#1-%E5%8F%8C%E5%A4%B4%E6%8C%87%E9%92%88">1. 双头指针</a></li>
<li><a href="#2-%E5%93%88%E5%B8%8C%E8%A1%A8">2. 哈希表</a></li>
</ul>
</li>
<li><a href="#%E4%B8%80-%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8">一. 买卖股票</a><ul>
<li><a href="#%E6%9A%B4%E5%8A%9B%E6%B3%95">暴力法</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C-%E5%8F%8D%E8%BD%AC%E5%AD%97%E7%AC%A6%E4%B8%B2">二. 反转字符串</a><ul>
<li><a href="#%E4%B8%80%E6%AC%A1%E9%81%8D%E5%8E%86">一次遍历</a></li>
<li><a href="#%E9%80%92%E5%BD%92%E6%B3%95">递归法</a></li>
</ul>
</li>
<li><a href="#%E4%B8%89-%E8%AE%A1%E7%AE%97%E6%95%B4%E6%95%B0n%E7%9A%84%E5%B9%B3%E6%96%B9%E6%A0%B9-%E7%B2%BE%E5%BA%A6%E4%B8%BA000001">三. 计算整数n的平方根  精度为0.00001</a><ul>
<li><a href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3%E6%B3%95">牛顿迭代法</a></li>
</ul>
</li>
<li><a href="#%E5%9B%9B-%E8%AE%A1%E7%AE%97%E6%95%B4%E6%95%B0n%E7%9A%84%E5%B9%B3%E6%96%B9%E6%A0%B9-%E8%BF%94%E5%9B%9E%E6%95%B4%E6%95%B0">四. 计算整数n的平方根 返回整数</a><ul>
<li><a href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3%E6%B3%95">牛顿迭代法：</a></li>
<li><a href="#%E4%BA%8C%E5%88%86%E6%B3%95">二分法:</a></li>
<li><a href="#%E7%94%A8%E9%99%A4%E6%B3%95%E9%81%BF%E5%85%8D-int-%E6%BA%A2%E5%87%BA%E7%9A%84%E6%83%85%E5%86%B5">用除法避免 int 溢出的情况</a></li>
</ul>
</li>
<li><a href="#%E4%BA%94-%E8%AE%A1%E7%AE%97%E6%B0%B4%E7%AE%B1%E5%AE%B9%E7%A7%AF">五. 计算水箱容积</a><ul>
<li><a href="#%E4%B8%80%E6%AC%A1%E9%81%8D%E5%8E%86-%E5%8F%8C%E6%8C%87%E9%92%88">一次遍历 （双指针）</a></li>
</ul>
</li>
<li><a href="#%E5%85%AD-%E6%95%B4%E6%95%B0%E8%BD%AC%E7%BD%97%E9%A9%AC%E6%95%B0%E5%AD%97-1012">六. 整数转罗马数字————–(10/12)</a><ul>
<li><a href="#haspmap-%E5%AD%98%E5%82%A8%E9%94%AE%E5%80%BC%E5%AF%B9-%E5%88%A4%E6%96%AD">HaspMap 存储键值对 判断</a></li>
<li><a href="#%E8%B4%AA%E5%BF%83%E6%B3%95int-string-%E5%9F%BA%E6%9C%AC%E6%95%B0%E7%BB%84-%E5%AF%B9%E5%BA%94%E5%AD%98%E5%82%A8"><strong>贪心法</strong>int String 基本数组 对应存储</a></li>
<li><a href="#%E6%80%9D%E8%80%83-7">思考</a><ul>
<li><a href="#hashmap-%E4%B8%AD%E7%9A%84get%E6%96%B9%E6%B3%95%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%98%AF%E5%90%A6%E4%B8%BAo1">HashMap 中的get方法时间复杂度是否为O（1）？</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E4%B8%83-%E7%94%B5%E8%AF%9D%E5%8F%B7%E7%A0%81%E7%9A%84%E5%AD%97%E6%AF%8D%E7%BB%84%E5%90%88-1012">七. 电话号码的字母组合  ———-（10/12）</a><ul>
<li><a href="#string%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BF%AD%E4%BB%A3">String类型的迭代</a></li>
<li><a href="#stringbuilder-%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%BF%AD%E4%BB%A3">StringBuilder 实现的迭代</a></li>
<li><a href="#%E6%80%9D%E8%80%83-8">思考</a></li>
</ul>
</li>
<li><a href="#%E5%85%AB-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E5%A4%A7%E6%B7%B1%E5%BA%A6">八. 二叉树的最大深度</a><ul>
<li><a href="#%E9%80%92%E5%BD%92%E6%B3%95-1">递归法</a></li>
<li><a href="#%E6%80%9D%E8%80%83-9">思考</a></li>
</ul>
</li>
<li><a href="#%E4%B9%9D-%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%9C%89%E5%BA%8F%E5%88%97%E8%A1%A8">九. 合并两个有序列表</a><ul>
<li><a href="#1-%E8%BF%AD%E4%BB%A3">1. 迭代</a></li>
<li><a href="#2-%E9%80%92%E5%BD%92">2. 递归</a></li>
<li><a href="#%E5%88%86%E6%9E%90">分析：</a></li>
</ul>
</li>
<li><a href="#%E5%8D%81-%E5%8F%8D%E8%BD%AC%E9%93%BE%E8%A1%A8-1016%E6%9C%AA%E5%AE%8C%E5%85%A8%E7%90%86%E8%A7%A3">十. 反转链表 ——–10.16未完全理解</a><ul>
<li><a href="#1-%E8%BF%AD%E4%BB%A3-1">1. 迭代</a></li>
<li><a href="#2-%E9%80%92%E5%BD%92-1">2. 递归</a></li>
</ul>
</li>
<li><a href="#%E5%8D%81%E4%B8%80-%E5%88%A0%E9%99%A4%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9">十一. 删除排序数组中的重复项</a><ul>
<li><a href="#1-%E6%9A%B4%E5%8A%9B%E4%B8%89%E5%BE%AA%E7%8E%AF-%E8%A7%A3%E9%9D%9E%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84">1. 暴力三循环 –解非排序数组</a></li>
<li><a href="#2-%E5%8F%8C%E6%8C%87%E9%92%88%E5%8D%95%E5%BE%AA%E7%8E%AF-%E8%A7%A3%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84">2. 双指针单循环 — 解排序数组</a></li>
<li><a href="#%E5%8F%8D%E6%80%9D">反思</a></li>
</ul>
</li>
<li><a href="#%E5%8D%81%E4%BA%8C-%E5%A4%96%E8%A7%82%E6%95%B0%E5%88%97">十二. 外观数列</a><ul>
<li><a href="#string-%E4%B8%8E-stringbuilder-%E5%85%B3%E4%BA%8E%E6%95%88%E7%8E%87%E5%92%8C%E9%80%92%E5%BD%92%E7%9A%84%E4%BD%BF%E7%94%A8">* String 与 StringBuilder 关于效率和递归的使用</a></li>
<li><a href="#1-%E9%80%92%E5%BD%92-1">1. 递归</a></li>
<li><a href="#2-%E7%9C%8B%E9%A2%98%E8%A7%A3%E5%90%8E%E7%9A%84%E7%BB%86%E8%8A%82%E8%B0%83%E6%95%B4">2. 看题解后的细节调整</a></li>
</ul>
</li>
<li><a href="#43-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E4%B9%98">43. 字符串相乘</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-3">思考：</a></li>
<li><a href="#1-my-%E8%87%AA%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%BF%9B%E4%BD%8D%E6%9C%BA%E5%88%B6">1. My 自实现的进位机制</a></li>
</ul>
</li>
<li><a href="#53-%E6%9C%80%E5%A4%A7%E5%AD%90%E5%BA%8F%E5%92%8C">53. 最大子序和</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-10">思考</a></li>
<li><a href="#1-my-dp">1. My DP</a></li>
<li><a href="#%E6%94%B9%E8%BF%9B">改进</a></li>
<li><a href="#3-%E5%88%86%E6%B2%BB-%E7%BA%BF%E6%AE%B5%E6%A0%91">3. 分治  线段树</a></li>
</ul>
</li>
<li><a href="#105-%E5%89%8D%E4%B8%AD%E5%BA%8F%E6%9E%84%E9%80%A0%E4%BA%8C%E5%8F%89%E6%A0%91">105. 前中序构造二叉树</a><ul>
<li><a href="#%E6%80%9D%E8%B7%AF-1">思路</a></li>
<li><a href="#1-my-%E9%80%92%E5%BD%92">1. My 递归</a></li>
<li><a href="#2-hashmap%E7%9A%84%E5%B0%8F%E6%94%B9%E8%BF%9B">2. hashmap的小改进</a></li>
<li><a href="#3-%E8%BF%AD%E4%BB%A3-%E6%A0%88">3. 迭代 + 栈</a></li>
</ul>
</li>
<li><a href="#146-lru%E7%BC%93%E5%AD%98">146. LRU缓存</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-11">思考</a></li>
<li><a href="#1-my-lruhashmap">1. My LruHashMap</a></li>
</ul>
</li>
<li><a href="#155-%E6%9C%80%E5%B0%8F%E6%A0%88">155. 最小栈</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-12">思考</a></li>
<li><a href="#1-%E8%87%AA%E5%AE%9A%E4%B9%89">1. 自定义</a></li>
</ul>
</li>
<li><a href="#263-%E4%B8%91%E6%95%B0">263. 丑数</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-13">思考</a></li>
<li><a href="#1-%E7%AE%80%E5%8D%95%E9%80%92%E5%BD%92">1. 简单递归</a></li>
<li><a href="#2-%E8%BF%AD%E4%BB%A3">2. 迭代</a></li>
</ul>
</li>
<li><a href="#300-%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97">300. 最长递增子序列</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-14">思考</a></li>
<li><a href="#1-%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84dp">1. 自己写的dp</a></li>
<li><a href="#2-%E7%9C%9F%E6%AD%A3%E7%9A%84dp">2. 真正的dp</a></li>
<li><a href="#%E8%B4%AA%E5%BF%83%E4%BA%8C%E5%88%86">贪心+二分</a></li>
</ul>
</li>
<li><a href="#322-%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2">322. 零钱兑换</a><ul>
<li><a href="#%E6%80%9D%E8%80%83-15">思考</a></li>
<li><a href="#1-%E8%AE%B0%E5%BF%86dfs">1. 记忆DFS</a></li>
<li><a href="#2-dp">2. DP</a></li>
</ul>
</li>
<li><a href="#lru%E5%AE%9E%E7%8E%B0">LRU实现</a></li>
<li><a href="#%E9%98%BF%E9%87%8C2020-%E6%A0%88%E6%B1%82%E8%A1%A8%E8%BE%BE%E5%BC%8F">阿里2020. 栈求表达式</a></li>
</ul>
<!-- tocstop -->

<hr>
<p>[TOC]</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/01/22/LeetCode%E5%88%B7%E9%A2%98/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/pipi.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yunlong626" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="401177923@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="401177923" target="_blank" title="QQ">
                      
                        <i class="fa fa-fw fa-qq"></i>QQ</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2020/12/28 &mdash; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">PiPiLong</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
